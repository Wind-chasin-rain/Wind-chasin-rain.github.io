<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>Vue3前端框架 | windCrain</title><meta name="author" content="麦子落"><meta name="copyright" content="麦子落"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Java前端技术基础，Vue3">
<meta property="og:type" content="article">
<meta property="og:title" content="Vue3前端框架">
<meta property="og:url" content="https://windcrain.top/post/Vue3/">
<meta property="og:site_name" content="windCrain">
<meta property="og:description" content="Java前端技术基础，Vue3">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://lmh-hexo-blog-img.oss-cn-hangzhou.aliyuncs.com/img/202307101631203.png">
<meta property="article:published_time" content="2023-07-10T08:31:55.000Z">
<meta property="article:modified_time" content="2023-07-22T15:54:30.363Z">
<meta property="article:author" content="麦子落">
<meta property="article:tag" content="前端">
<meta property="article:tag" content="Vue">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://lmh-hexo-blog-img.oss-cn-hangzhou.aliyuncs.com/img/202307101631203.png"><link rel="shortcut icon" href="https://lmh-hexo-blog-img.oss-cn-hangzhou.aliyuncs.com/img/202206081622763.png"><link rel="canonical" href="https://windcrain.top/post/Vue3/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":1000},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: true,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Vue3前端框架',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-07-22 23:54:30'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/font.css"><script src="https://cdn1.tianli0.top/npm/flv.js/dist/flv.min.js"></script><script src="https://cdn1.tianli0.top/npm/dplayer/dist/DPlayer.min.js"></script><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="windCrain" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>const preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> { preloader.endLoading() })

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "/img/loading.gif" data-lazy-src="https://lmh-hexo-blog-img.oss-cn-hangzhou.aliyuncs.com/img/202206081622744.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">37</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">28</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://lmh-hexo-blog-img.oss-cn-hangzhou.aliyuncs.com/img/202307101631203.png')"><nav id="nav"><span id="blog-info"><a href="/" title="windCrain"><span class="site-name">windCrain</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Vue3前端框架</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-07-10T08:31:55.000Z" title="发表于 2023-07-10 16:31:55">2023-07-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-07-22T15:54:30.363Z" title="更新于 2023-07-22 23:54:30">2023-07-22</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">13.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>72分钟</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>技术选型</p>
<ul>
<li>Vue <ul>
<li><strong>选项式 API</strong> 还是 <strong>组合式 API</strong>✔️</li>
<li><strong>HTML</strong> 还是 <strong>单文件组件</strong>✔️</li>
</ul>
</li>
<li>语法<ul>
<li><strong>javascript</strong> 还是 <strong>typescript</strong>✔️</li>
</ul>
</li>
<li>构建工具<ul>
<li><strong>@vue/cli</strong> 还是 <strong>vite</strong>✔️</li>
</ul>
</li>
<li>路由<ul>
<li><strong>vue-router</strong>✔️</li>
</ul>
</li>
<li>共享存储<ul>
<li><strong>vuex</strong> 还是 <strong>pinia</strong>✔️</li>
</ul>
</li>
<li>视图组件<ul>
<li><strong>ElementUI</strong> 还是 <strong>Antdv</strong>✔️</li>
</ul>
</li>
</ul>
<p><br></p>
<h1 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h1><h2 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h2><p>采用 vite 作为前端项目的打包，构建工具</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init vite@latest</span><br></pre></td></tr></table></figure>
<p>按提示操作</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> 项目目录</span><br><span class="line">npm install</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="编码-IDE"><a href="#编码-IDE" class="headerlink" title="编码 IDE"></a>编码 IDE</h2><p>推荐采用微软的 VSCode 作为开发工具，到它的官网 <a target="_blank" rel="noopener" href="https://code.visualstudio.com/">Visual Studio Code - Code Editing. Redefined</a> 下载安装即可</p>
<p>要对 *.vue 做语法支持，还要安装一个 Volar 插件</p>
<p><br></p>
<h2 id="安装-devtools"><a href="#安装-devtools" class="headerlink" title="安装 devtools"></a>安装 devtools</h2><ul>
<li>devtools 插件网址：<a target="_blank" rel="noopener" href="https://devtools.vuejs.org/guide/installation.html">https://devtools.vuejs.org/guide/installation.html</a></li>
</ul>
<p><br></p>
<h2 id="修改端口"><a href="#修改端口" class="headerlink" title="修改端口"></a>修改端口</h2><p>打开项目根目录下 vite.config.ts</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// https://vitejs.dev/config/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="title function_">vue</span>()],</span><br><span class="line">  <span class="attr">server</span>: &#123;</span><br><span class="line">    <span class="attr">port</span>: <span class="number">7070</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>文档地址：<a target="_blank" rel="noopener" href="https://vitejs.cn/config/#server-port">配置 Vite | Vite中文网 (vitejs.cn)</a></li>
</ul>
<p><br></p>
<h2 id="配置代理"><a href="#配置代理" class="headerlink" title="配置代理"></a>配置代理</h2><p>为了避免前后端服务器联调时， fetch、xhr 请求产生跨域问题，需要配置代理，同样是修改项目根目录下 vite.config.ts</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// https://vitejs.dev/config/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="title function_">vue</span>()],</span><br><span class="line">  <span class="attr">server</span>: &#123;</span><br><span class="line">    <span class="attr">port</span>: <span class="number">7070</span>,</span><br><span class="line">    <span class="attr">proxy</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;/api&#x27;</span>: &#123;</span><br><span class="line">        <span class="attr">target</span>: <span class="string">&#x27;http://localhost:8080&#x27;</span>,</span><br><span class="line">        <span class="attr">changeOrigin</span>: <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">index.html</span><br><span class="line">package.json</span><br><span class="line">tsconfig.json</span><br><span class="line">vite.config.ts</span><br><span class="line">├─public</span><br><span class="line">└─src</span><br><span class="line">    ├─assets</span><br><span class="line">    ├─components</span><br><span class="line">    ├─model</span><br><span class="line">    ├─router</span><br><span class="line">    ├─store</span><br><span class="line">    └─views</span><br></pre></td></tr></table></figure>
<ul>
<li>index.html 为主页面</li>
<li>package.json npm 配置文件</li>
<li>tsconfig.json typescript 配置文件</li>
<li>vite.config.ts vite 配置文件</li>
<li>public 静态资源</li>
<li>src/components 可重用组件</li>
<li>src/model 模型定义</li>
<li>src/router 路由</li>
<li>src/store 共享存储</li>
<li>src/views 视图组件</li>
</ul>
<p><br></p>
<h1 id="Vue-组件"><a href="#Vue-组件" class="headerlink" title="Vue 组件"></a>Vue 组件</h1><p>Vue 的组件文件以 .vue 结尾，每个组件由三部分组成</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>script 代码部分，控制模板的数据来源和行为</li>
<li>template 模板部分，由它生成 html 代码</li>
<li>style 样式部分，一般不咋关心</li>
</ul>
<p>根组件是 src/App.vue，先来个 Hello,world 例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref &#125; from &quot;vue&quot;;</span><br><span class="line">let msg = ref(&quot;hello&quot;); // 把数据变成响应式的</span><br><span class="line"></span><br><span class="line">function change() &#123;</span><br><span class="line">  msg.value = &quot;world&quot;;</span><br><span class="line">  console.log(msg);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h1&gt;&#123;&#123; msg &#125;&#125;&lt;/h1&gt;</span><br><span class="line">  &lt;input type=&quot;button&quot; value=&quot;修改msg&quot; @click=&quot;change&quot; /&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li> 用来把一个变量绑定到页面上某个位置</li>
<li>绑定的变量必须用 ref 函数来封装<ul>
<li>ref 返回的是【响应式】数据，即数据一旦变化，页面展示也跟着变化</li>
</ul>
</li>
</ul>
<p><br></p>
<h2 id="main-ts"><a href="#main-ts" class="headerlink" title="main.ts"></a>main.ts</h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./style.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line">  .<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>createApp 是创建一个 Vue 应用程序，它接收的参数 App 即之前我们看到的根组件</li>
<li>mount 就是把根组件生成的 html 代码片段【挂载】到 index.html 中 id 为 app 的 html 元素上</li>
</ul>
<p>可以修改自己的组件文件，挂载到主页面</p>
<p>新建 src/views/E0.vue，内容如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line">const msg = ref(&#x27;Hello, World!!&#x27;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h1&gt;&#123;&#123; msg &#125;&#125;&lt;/h1&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<p>修改 main.ts 将自己的组件文件挂载</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./style.css&#x27;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="variable constant_">E0</span> <span class="keyword">from</span> <span class="string">&#x27;./views/E0.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">createApp</span>(<span class="variable constant_">E0</span>).<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="ref-与-reactive"><a href="#ref-与-reactive" class="headerlink" title="ref 与 reactive"></a>ref 与 reactive</h2><p>vue 提供了两个函数，都可以将数据变为【响应式】的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref, reactive &#125; from &#x27;vue&#x27;</span><br><span class="line">const msg = ref(&#x27;Hello, World&#x27;)</span><br><span class="line">const user = reactive(&#123; name: &#x27;张三&#x27; &#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h2&gt;&#123;&#123;msg&#125;&#125;&lt;/h2&gt;</span><br><span class="line">  &lt;h2&gt;&#123;&#123;user.name&#125;&#125;&lt;/h2&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>ref 能将任意类型的数据变为【响应式】的</li>
<li>reactive 只能将对象类型变为【响应式】，对基本类型无效（例如 string，number，boolean）</li>
</ul>
<p>还有一点不同</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref, reactive &#125; from &#x27;vue&#x27;</span><br><span class="line">const u1 = ref(&#123; name: &#x27;张三&#x27; &#125;)</span><br><span class="line">const u2 = reactive(&#123; name: &#x27;张三&#x27; &#125;)</span><br><span class="line"></span><br><span class="line">function test() &#123;</span><br><span class="line">  console.log(u1.value)</span><br><span class="line">  console.log(u2)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">  </span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h2&gt;&#123;&#123;u1.name&#125;&#125;&lt;/h2&gt;</span><br><span class="line">  &lt;h2&gt;&#123;&#123;u2.name&#125;&#125;&lt;/h2&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>在 template 模板中使用 ref 包装的数据，直接写【变量名】就可以了</li>
<li>但在代码中要使用 ref 包装的数据，必须用【变量名.value】才能访问到</li>
<li>reactive 包装的数据，在模板中和代码中都是一致的</li>
</ul>
<p><br></p>
<h2 id="属性绑定"><a href="#属性绑定" class="headerlink" title="属性绑定"></a>属性绑定</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line">const path = ref(&#x27;/src/assets/vue.svg&#x27;)</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;img :src=&quot;path&quot; alt=&quot;&quot;&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>【:属性名】用来将标签属性与【响应式】变量绑定</li>
</ul>
<p><br></p>
<h2 id="事件绑定"><a href="#事件绑定" class="headerlink" title="事件绑定"></a>事件绑定</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line">const count = ref(0)</span><br><span class="line">function dec() &#123;</span><br><span class="line">  count.value--</span><br><span class="line">&#125;</span><br><span class="line">function inc() &#123;</span><br><span class="line">  count.value++</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;input type=&quot;button&quot; value=&quot;-&quot; @click=&quot;dec&quot;&gt;</span><br><span class="line">  &lt;h2&gt;&#123;&#123;count&#125;&#125;&lt;/h2&gt;</span><br><span class="line">  &lt;input type=&quot;button&quot; value=&quot;+&quot; @click=&quot;inc&quot;&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>【@事件名】用来将标签属性与函数绑定，事件发生后执行函数内代码</li>
</ul>
<p><br></p>
<h2 id="表单绑定"><a href="#表单绑定" class="headerlink" title="表单绑定"></a>表单绑定</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref &#125; from &quot;vue&quot;;</span><br><span class="line">const user = ref(&#123;</span><br><span class="line">  name:&#x27;张三&#x27;,</span><br><span class="line">  age:18,</span><br><span class="line">  sex:&#x27;男&#x27;,</span><br><span class="line">  fav:[&#x27;游泳&#x27;,&#x27;打球&#x27;]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">function saveUser() &#123;</span><br><span class="line">  console.log(user.value)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;outer&quot;&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;label for=&quot;&quot;&gt;请输入姓名&lt;/label&gt;</span><br><span class="line">      &lt;input type=&quot;text&quot; v-model=&quot;user.name&quot;/&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;label for=&quot;&quot;&gt;请输入年龄&lt;/label&gt;</span><br><span class="line">      &lt;input type=&quot;text&quot; v-model=&quot;user.age&quot;/&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;label for=&quot;&quot;&gt;请选择性别&lt;/label&gt;</span><br><span class="line">      男 &lt;input type=&quot;radio&quot; value=&quot;男&quot; v-model=&quot;user.sex&quot;/&gt; </span><br><span class="line">      女 &lt;input type=&quot;radio&quot; value=&quot;女&quot; v-model=&quot;user.sex&quot;/&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;label for=&quot;&quot;&gt;请选择爱好&lt;/label&gt;</span><br><span class="line">      游泳 &lt;input type=&quot;checkbox&quot; value=&quot;游泳&quot; v-model=&quot;user.fav&quot;/&gt; </span><br><span class="line">      打球 &lt;input type=&quot;checkbox&quot; value=&quot;打球&quot; v-model=&quot;user.fav&quot;/&gt; </span><br><span class="line">      健身 &lt;input type=&quot;checkbox&quot; value=&quot;健身&quot; v-model=&quot;user.fav&quot;/&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;input type=&quot;button&quot; value=&quot;保存&quot; @click=&quot;saveUser&quot;&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">  div &#123;</span><br><span class="line">    margin-bottom: 8px;</span><br><span class="line">  &#125;</span><br><span class="line">  .outer &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    position: relative;</span><br><span class="line">    padding-left: 80px;</span><br><span class="line">  &#125;</span><br><span class="line">  label &#123;</span><br><span class="line">    text-align: left;</span><br><span class="line">    width: 100px;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    position: absolute;</span><br><span class="line">    left :0;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>用 v-model 实现双向绑定，即 <ul>
<li>javascript 数据可以同步到表单标签</li>
<li>反过来用户在表单标签输入的新值也会同步到 javascript 这边</li>
</ul>
</li>
<li>双向绑定只适用于表单这种带【输入】功能的标签，其它标签的数据绑定，单向就足够了</li>
<li>复选框这种标签，双向绑定的 javascript 数据类型一般用数组</li>
</ul>
<p><br></p>
<h2 id="计算属性"><a href="#计算属性" class="headerlink" title="计算属性"></a>计算属性</h2><p>有时在数据展示时要做简单的计算</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line">const firstName = ref(&#x27;三&#x27;)</span><br><span class="line">const lastName = ref(&#x27;张&#x27;)</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h2&gt;&#123;&#123;lastName + firstName&#125;&#125;&lt;/h2&gt;</span><br><span class="line">  &lt;h3&gt;&#123;&#123;lastName + firstName&#125;&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;h4&gt;&#123;&#123;lastName + firstName&#125;&#125;&lt;/h4&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<p>看起来较为繁琐，可以用计算属性改进</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref, computed &#125; from &#x27;vue&#x27;</span><br><span class="line">const firstName = ref(&#x27;三&#x27;)</span><br><span class="line">const lastName = ref(&#x27;张&#x27;)</span><br><span class="line">const fullName = computed(() =&gt; &#123;</span><br><span class="line">  console.log(&#x27;enter&#x27;)</span><br><span class="line">  return lastName.value + firstName.value</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h2&gt;&#123;&#123;fullName&#125;&#125;&lt;/h2&gt;</span><br><span class="line">  &lt;h3&gt;&#123;&#123;fullName&#125;&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;h4&gt;&#123;&#123;fullName&#125;&#125;&lt;/h4&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>fullName 即为计算属性，它具备缓存功能，即 firstName 和 lastName 的值发生了变化，才会重新计算</li>
<li>如果用函数实现相同功能，则没有缓存功能</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line">const firstName = ref(&#x27;三&#x27;)</span><br><span class="line">const lastName = ref(&#x27;张&#x27;)</span><br><span class="line">function fullName() &#123;</span><br><span class="line">  console.log(&#x27;enter&#x27;)</span><br><span class="line">  return lastName.value + firstName.value</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">  </span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h2&gt;&#123;&#123;fullName()&#125;&#125;&lt;/h2&gt;</span><br><span class="line">  &lt;h3&gt;&#123;&#123;fullName()&#125;&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;h4&gt;&#123;&#123;fullName()&#125;&#125;&lt;/h4&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="xhr"><a href="#xhr" class="headerlink" title="xhr"></a>xhr</h2><p>浏览器中有两套 API 可以和后端交互，发送请求、接收响应，fetch api 前面我们已经介绍过了，另一套 api 是 xhr，基本用法如下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line">xhr.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">response</span>)</span><br><span class="line">&#125;</span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;http://localhost:8080/api/students&#x27;</span>)</span><br><span class="line">xhr.<span class="property">responseType</span> = <span class="string">&quot;json&quot;</span></span><br><span class="line">xhr.<span class="title function_">send</span>()</span><br></pre></td></tr></table></figure>
<p>但这套 api 虽然功能强大，但比较老，不直接支持 Promise，因此有必要对其进行改造</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">get</span>(<span class="params">url: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line">    xhr.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span>(xhr.<span class="property">status</span> === <span class="number">200</span>)&#123;</span><br><span class="line">        <span class="title function_">resolve</span>(xhr.<span class="property">response</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span>(xhr.<span class="property">status</span> === <span class="number">404</span>) &#123;</span><br><span class="line">        <span class="title function_">reject</span>(xhr.<span class="property">response</span>)</span><br><span class="line">      &#125; <span class="comment">// 其它情况也需考虑，这里简化处理</span></span><br><span class="line">    &#125;</span><br><span class="line">    xhr.<span class="title function_">open</span>(<span class="string">&#x27;GET&#x27;</span>, url)</span><br><span class="line">    xhr.<span class="property">responseType</span> = <span class="string">&#x27;json&#x27;</span></span><br><span class="line">    xhr.<span class="title function_">send</span>()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Promise 对象适合用来封装异步操作，并可以配合 await 一齐使用</li>
<li>Promise 在构造时，需要一个箭头函数，箭头函数有两个参数 resolve 和 reject<ul>
<li>resolve 是异步操作成功时被调用，把成功的结果传递给它，最后会作为 await 的结果返回</li>
<li>reject 在异步操作失败时被调用，把失败的结果传递给它，最后在 catch 块被捉住</li>
</ul>
</li>
<li>await 会一直等到 Promise 内调用了 resolve 或 reject 才会继续向下运行</li>
</ul>
<p>调用示例1：同步接收结果，不走代理</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> resp = <span class="keyword">await</span> <span class="title function_">get</span>(<span class="string">&quot;http://localhost:8080/api/students&quot;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(resp)</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">error</span>(e)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>调用示例2：走代理</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> resp = <span class="keyword">await</span> <span class="title function_">get</span>(<span class="string">&#x27;/api/students&#x27;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(resp)  </span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(e)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>走代理明显慢不少</li>
</ul>
<p><br></p>
<h2 id="axios"><a href="#axios" class="headerlink" title="axios"></a>axios</h2><p><strong>基本用法</strong></p>
<p>axios 就是对 xhr api 的封装，语法与前面例子类似</p>
<p>安装</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install axios</span><br></pre></td></tr></table></figure>
<p>一个简单的例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref, onMounted &#125; from &quot;vue&quot;;</span><br><span class="line">import axios from &quot;axios&quot;;</span><br><span class="line"></span><br><span class="line">let count = ref(0);</span><br><span class="line"></span><br><span class="line">async function getStudents() &#123;</span><br><span class="line">  try &#123;</span><br><span class="line">    const resp = await axios.get(&quot;/api/students&quot;);</span><br><span class="line">    count.value = resp.data.data.length;</span><br><span class="line">  &#125; catch (e) &#123;</span><br><span class="line">    console.log(e);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  getStudents()</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h2&gt;学生人数为：&#123;&#123; count &#125;&#125;&lt;/h2&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>onMounted 指 vue 组件生成的 html 代码片段，挂载完毕后被执行</li>
</ul>
<p>再来看一个 post 例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref &#125; from &quot;vue&quot;;</span><br><span class="line">import axios from &quot;axios&quot;;</span><br><span class="line"></span><br><span class="line">const student = ref(&#123;</span><br><span class="line">  name: &#x27;&#x27;,</span><br><span class="line">  sex: &#x27;男&#x27;,</span><br><span class="line">  age: 18</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">async function addStudent() &#123;</span><br><span class="line">  console.log(student.value)</span><br><span class="line">  const resp = await axios.post(&#x27;/api/students&#x27;, student.value)</span><br><span class="line">  console.log(resp.data.data)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;input type=&quot;text&quot; placeholder=&quot;请输入姓名&quot; v-model=&quot;student.name&quot;/&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;label for=&quot;&quot;&gt;请选择性别&lt;/label&gt;</span><br><span class="line">      男 &lt;input type=&quot;radio&quot; value=&quot;男&quot; v-model=&quot;student.sex&quot;/&gt; </span><br><span class="line">      女 &lt;input type=&quot;radio&quot; value=&quot;女&quot; v-model=&quot;student.sex&quot;/&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;input type=&quot;number&quot; placeholder=&quot;请输入年龄&quot; v-model=&quot;student.age&quot;/&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;input type=&quot;button&quot; value=&quot;添加&quot; @click=&quot;addStudent&quot;/&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">div &#123;</span><br><span class="line">  font-size: 14px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p><br></p>
<p><strong>环境变量</strong></p>
<ul>
<li>开发环境下，联调的后端服务器地址是 <code>http://localhost:8080</code>，</li>
<li>上线改为生产环境后，后端服务器地址为 <code>http://itheima.com</code></li>
</ul>
<p>这就要求我们区分开发环境和生产环境，这件事交给构建工具 vite 来做</p>
<p>默认情况下，vite 支持上面两种环境，分别对应根目录下两个配置文件 </p>
<ul>
<li>.env.development - 开发环境</li>
<li>.env.production - 生产环境</li>
</ul>
<p>针对以上需求，分别在两个文件中加入</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">VITE_BACKEND_API_BASE_URL</span> = <span class="string">&#x27;http://localhost:8080&#x27;</span></span><br></pre></td></tr></table></figure>
<p>和</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">VITE_BACKEND_API_BASE_URL</span> = <span class="string">&#x27;http://itheima.com&#x27;</span></span><br></pre></td></tr></table></figure>
<p>然后在代码中使用 vite 给我们提供的特殊对象 <code>import.meta.env</code>，就可以获取到 <code>VITE_BACKEND_API_BASE_URL</code> 在不同环境下的值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">VITE_BACKEND_API_BASE_URL</span></span><br></pre></td></tr></table></figure>
<p>默认情况下，不能智能提示自定义的环境变量，做如下配置：新增文件 <code>src/env.d.ts</code> 并添加如下内容</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// &lt;reference types=&quot;vite/client&quot; /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ImportMetaEnv</span> &#123;</span><br><span class="line">  <span class="keyword">readonly</span> <span class="attr">VITE_BACKEND_API_BASE_URL</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">// 更多环境变量...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ImportMeta</span> &#123;</span><br><span class="line">  <span class="keyword">readonly</span> <span class="attr">env</span>: <span class="title class_">ImportMetaEnv</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>参考文档地址 <a target="_blank" rel="noopener" href="https://cn.vitejs.dev/guide/env-and-mode.html">环境变量和模式 | Vite 官方中文文档 (vitejs.dev)</a></li>
</ul>
<p><br></p>
<p><strong>baseURL</strong></p>
<p>可以自己创建一个 axios 对象，方便添加默认设置，新建文件 /src/api/request.ts</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建新的 axios 对象</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="keyword">const</span> _axios = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">baseURL</span>: <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">VITE_BACKEND_API_BASE_URL</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> _axios</span><br></pre></td></tr></table></figure>
<p>然后在其它组件中引用这个 ts 文件，例如 /src/views/E8.vue，就不用自己拼接路径前缀了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import axios from &#x27;../api/request&#x27;</span><br><span class="line">// ...</span><br><span class="line">await axios.post(&#x27;/api/students&#x27;, ...)    </span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p><br></p>
<p><strong>拦截器</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建新的 axios 对象</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="keyword">const</span> _axios = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">baseURL</span>: <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">VITE_BACKEND_API_BASE_URL</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 请求拦截器</span></span><br><span class="line">_axios.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">config</span>)=&gt;</span>&#123; <span class="comment">// 统一添加请求头</span></span><br><span class="line">    config.<span class="property">headers</span> = &#123;</span><br><span class="line">      <span class="title class_">Authorization</span>: <span class="string">&#x27;aaa.bbb.ccc&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">error</span>)=&gt;</span>&#123; <span class="comment">// 请求出错时的处理</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 响应拦截器</span></span><br><span class="line">_axios.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">response</span>)=&gt;</span>&#123; <span class="comment">// 状态码  2xx</span></span><br><span class="line">    <span class="comment">// 这里的code是自定义的错误码</span></span><br><span class="line">    <span class="keyword">if</span>(response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> response</span><br><span class="line">    &#125;     </span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">401</span>) &#123;       </span><br><span class="line">      <span class="comment">// 情况1</span></span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(&#123;&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ... </span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">error</span>)=&gt;</span>&#123; <span class="comment">// 状态码 &gt; 2xx, 400,401,403,404,500</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(error) <span class="comment">// 处理了异常</span></span><br><span class="line">    <span class="keyword">if</span>(error.<span class="property">response</span>.<span class="property">status</span> === <span class="number">400</span>) &#123;</span><br><span class="line">      <span class="comment">// 情况1</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(error.<span class="property">response</span>.<span class="property">status</span> === <span class="number">401</span>) &#123;</span><br><span class="line">      <span class="comment">// 情况2</span></span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(&#123;&#125;)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> _axios</span><br></pre></td></tr></table></figure>
<p>处理响应时，又分成两种情况</p>
<ol>
<li>后端返回的是标准响应状态码，这时会走响应拦截器第二个箭头函数，用 error.response.status 做分支判断</li>
<li>后端返回的响应状态码总是200，用自定义错误码表示出错，这时会走响应拦截器第一个箭头函数，用 response.data.code 做分支判断</li>
</ol>
<p>另外</p>
<ul>
<li>Promise.reject(error) 类似于将异常继续向上抛出，异常由调用者（Vue组件）来配合 try … catch 来处理</li>
<li>Promise.resolve({}) 表示错误已解决，返回一个空对象，调用者中接到这个空对象时，需要配合 ?. 来避免访问不存在的属性</li>
</ul>
<p><br></p>
<h2 id="条件与列表"><a href="#条件与列表" class="headerlink" title="条件与列表"></a>条件与列表</h2><p>首先，新增模型数据 src/model/Model8080.ts</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">sex</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果 spring 错误，返回的对象格式</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">SpringError</span> &#123;</span><br><span class="line">  <span class="attr">timestamp</span>: <span class="built_in">string</span>,</span><br><span class="line">  <span class="attr">status</span>: <span class="built_in">number</span>,</span><br><span class="line">  <span class="attr">error</span>: <span class="built_in">string</span>,</span><br><span class="line">  <span class="attr">message</span>: <span class="built_in">string</span>,</span><br><span class="line">  <span class="attr">path</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果 spring 成功，返回 list 情况</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">SpringList</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="attr">data</span>: T[],</span><br><span class="line">  message?: <span class="built_in">string</span>,</span><br><span class="line">  <span class="attr">code</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果 spring 成功，返回 page 情况</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">SpringPage</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="attr">data</span>: &#123; <span class="attr">list</span>: T[], <span class="attr">total</span>: <span class="built_in">number</span> &#125;,</span><br><span class="line">  message?: <span class="built_in">string</span>,</span><br><span class="line">  <span class="attr">code</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果 spring 成功，返回 string 情况</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">SpringString</span> &#123;</span><br><span class="line">  <span class="attr">data</span>: <span class="built_in">string</span>,</span><br><span class="line">  message?: <span class="built_in">string</span>,</span><br><span class="line">  <span class="attr">code</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AxiosResponse</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">AxiosRespError</span> <span class="keyword">extends</span> <span class="title class_">AxiosResponse</span>&lt;<span class="title class_">SpringError</span>&gt; &#123; &#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">AxiosRespList</span>&lt;T&gt; <span class="keyword">extends</span> <span class="title class_">AxiosResponse</span>&lt;<span class="title class_">SpringList</span>&lt;T&gt;&gt; &#123; &#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">AxiosRespPage</span>&lt;T&gt; <span class="keyword">extends</span> <span class="title class_">AxiosResponse</span>&lt;<span class="title class_">SpringPage</span>&lt;T&gt;&gt; &#123; &#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">AxiosRespString</span> <span class="keyword">extends</span> <span class="title class_">AxiosResponse</span>&lt;<span class="title class_">SpringString</span>&gt; &#123; &#125;</span><br></pre></td></tr></table></figure>
<p>其中 </p>
<ul>
<li>AxiosRespPage 代表分页时的响应类型</li>
<li>AxiosRespList 代表返回集合时的响应类型</li>
<li>AxiosRespString 代表返回字符串时的响应类型</li>
<li>AxiosRespError 代表 Spring 出错时时的响应类型</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">import &#123; ref, onMounted &#125; from &quot;vue&quot;;</span><br><span class="line">import axios from &quot;../api/request&quot;;</span><br><span class="line">import &#123; Student, SpringList &#125; from &quot;../model/Model8080&quot;;</span><br><span class="line"></span><br><span class="line">// 说明 students 数组类型为 Student[]</span><br><span class="line">const students = ref&lt;Student[]&gt;([]);</span><br><span class="line"></span><br><span class="line">async function getStudents() &#123;</span><br><span class="line">  // 说明 resp.data 类型是 SpringList&lt;Student&gt;</span><br><span class="line">  const resp = await axios.get&lt;SpringList&lt;Student&gt;&gt;(&quot;/api/students&quot;);  </span><br><span class="line">  console.log(resp.data.data);</span><br><span class="line">  students.value = resp.data.data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; getStudents());</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;outer&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;title&quot;&gt;学生列表&lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;thead&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;row bold&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;col&quot;&gt;编号&lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;col&quot;&gt;姓名&lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;col&quot;&gt;性别&lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;col&quot;&gt;年龄&lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;tbody&quot;&gt;</span><br><span class="line">      &lt;div v-if=&quot;students.length === 0&quot;&gt;暂无数据&lt;/div&gt;</span><br><span class="line">      &lt;template v-else&gt;</span><br><span class="line">        &lt;div class=&quot;row&quot; v-for=&quot;s of students&quot; :key=&quot;s.id&quot;&gt;</span><br><span class="line">          &lt;div class=&quot;col&quot;&gt;&#123;&#123; s.id &#125;&#125;&lt;/div&gt;</span><br><span class="line">          &lt;div class=&quot;col&quot;&gt;&#123;&#123; s.name &#125;&#125;&lt;/div&gt;</span><br><span class="line">          &lt;div class=&quot;col&quot;&gt;&#123;&#123; s.sex &#125;&#125;&lt;/div&gt;</span><br><span class="line">          &lt;div class=&quot;col&quot;&gt;&#123;&#123; s.age &#125;&#125;&lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.outer &#123;</span><br><span class="line">  font-family: 华文行楷;</span><br><span class="line">  font-size: 20px;</span><br><span class="line">  width: 500px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.title &#123;</span><br><span class="line">  margin-bottom: 10px;</span><br><span class="line">  font-size: 30px;</span><br><span class="line">  color: #333;</span><br><span class="line">  text-align: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.row &#123;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.col &#123;</span><br><span class="line">  border: 1px solid #f0f0f0;</span><br><span class="line">  width: 15%;</span><br><span class="line">  height: 35px;</span><br><span class="line">  text-align: center;</span><br><span class="line">  line-height: 35px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.bold .col &#123;</span><br><span class="line">  background-color: #f1f1f1;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>加入泛型是为了更好的提示</li>
<li>v-if 与 v-else 不能和 v-for 处于同一标签</li>
<li>template 标签还有一个用途，就是用它少生成一层真正 html 代码</li>
<li>可以看到将结果封装为响应式数据还是比较繁琐的，后面会使用 useRequest 改进</li>
</ul>
<p><br></p>
<h2 id="监听器"><a href="#监听器" class="headerlink" title="监听器"></a>监听器</h2><p>利用监听器，可以在【响应式】的基础上添加一些副作用，把更多的东西变成【响应式的】</p>
<ul>
<li><p>原本只是数据变化 =&gt; 页面更新</p>
</li>
<li><p>watch 可以在数据变化时 =&gt; 其它更新</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;input type=&quot;text&quot; v-model=&quot;name&quot; /&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref, watch &#125; from &quot;vue&quot;;</span><br><span class="line">function useStorage(name: string) &#123;</span><br><span class="line">  const data = ref(sessionStorage.getItem(name) ?? &quot;&quot;);</span><br><span class="line">  watch(data, (newValue) =&gt; &#123;</span><br><span class="line">    sessionStorage.setItem(name, newValue);</span><br><span class="line">  &#125;);</span><br><span class="line">  return data;</span><br><span class="line">&#125;</span><br><span class="line">const name = useStorage(&quot;name&quot;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>名称为 useXXXX 的函数，作用是返回带扩展功能的【响应式】数据</li>
<li>localStorage   即使浏览器关闭，数据还在</li>
<li>sessionStorage  数据工作在浏览器活动期间</li>
</ul>
<p><br></p>
<h2 id="vueuse"><a href="#vueuse" class="headerlink" title="vueuse"></a>vueuse</h2><p>安装</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @vueuse/core</span><br></pre></td></tr></table></figure>
<p>一些函数的用法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h3&gt;X: &#123;&#123;x&#125;&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;h3&gt;Y: &#123;&#123;y&#125;&#125;&lt;/h3&gt;</span><br><span class="line"></span><br><span class="line">  &lt;h3&gt;&#123;&#123;count&#125;&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;input type=&quot;button&quot; @click=&quot;inc()&quot; value=&quot;+&quot;&gt;</span><br><span class="line">  &lt;input type=&quot;button&quot; @click=&quot;dec()&quot; value=&quot;-&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;input type=&quot;text&quot; v-model=&quot;name&quot;&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; useMouse, useCounter, useStorage &#125; from &#x27;@vueuse/core&#x27;</span><br><span class="line"></span><br><span class="line">const &#123;x, y&#125; = useMouse()</span><br><span class="line"></span><br><span class="line">const &#123;count, inc, dec&#125; = useCounter()</span><br><span class="line"></span><br><span class="line">const name = useStorage(&quot;name&quot;, &quot;&quot;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="useRequest"><a href="#useRequest" class="headerlink" title="useRequest"></a>useRequest</h2><p>响应式的 axios 封装，官网地址 <a target="_blank" rel="noopener" href="https://next.cn.attojs.org/">一个 Vue 请求库 | VueRequest (attojs.org)</a></p>
<p>首先安装 vue-request</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vue-request@next</span><br></pre></td></tr></table></figure>
<p>组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h3 v-if=&quot;students.length === 0&quot;&gt;暂无数据&lt;/h3&gt;</span><br><span class="line">  &lt;ul v-else&gt;</span><br><span class="line">    &lt;li v-for=&quot;s of students&quot; :key=&quot;s.id&quot;&gt;</span><br><span class="line">      &lt;span&gt;&#123;&#123;s.name&#125;&#125;&lt;/span&gt;</span><br><span class="line">      &lt;span&gt;&#123;&#123;s.sex&#125;&#125;&lt;/span&gt;</span><br><span class="line">      &lt;span&gt;&#123;&#123;s.age&#125;&#125;&lt;/span&gt;</span><br><span class="line">    &lt;/li&gt;</span><br><span class="line">  &lt;/ul&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import axios from &quot;../api/request&quot;</span><br><span class="line">import &#123; useRequest &#125; from &#x27;vue-request&#x27;</span><br><span class="line">import &#123; computed &#125; from &#x27;vue&#x27;</span><br><span class="line">import &#123; AxiosRespList, Student &#125; from &#x27;../model/Model8080&#x27;</span><br><span class="line"></span><br><span class="line">// data 代表就是 axios 的响应对象</span><br><span class="line">const &#123; data &#125; = useRequest&lt;AxiosRespList&lt;Student&gt;&gt;(() =&gt; axios.get(&#x27;/api/students&#x27;))</span><br><span class="line"></span><br><span class="line">const students = computed(()=&gt;&#123;</span><br><span class="line">  return data?.value?.data.data || []</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">ul li &#123;</span><br><span class="line">  list-style: none;</span><br><span class="line">  font-family: &quot;华文行楷&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">li span:nth-child(1) &#123;</span><br><span class="line">  font-size: 24px;</span><br><span class="line">&#125;</span><br><span class="line">li span:nth-child(2) &#123;</span><br><span class="line">  font-size: 12px;</span><br><span class="line">  color: crimson;</span><br><span class="line">  vertical-align: bottom;</span><br><span class="line">&#125;</span><br><span class="line">li span:nth-child(3) &#123;</span><br><span class="line">  font-size: 12px;</span><br><span class="line">  color: darkblue;</span><br><span class="line">  vertical-align: top;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>data.value 的取值一开始是 undefined，随着响应返回变成 axios 的响应对象</li>
<li>用 computed 进行适配</li>
</ul>
<p><br></p>
<h2 id="usePagination"><a href="#usePagination" class="headerlink" title="usePagination"></a>usePagination</h2><p>在 src/model/Model8080.ts 中补充类型说明</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">StudentQueryDto</span> &#123;</span><br><span class="line">  name?: <span class="built_in">string</span>,</span><br><span class="line">  sex?: <span class="built_in">string</span>,</span><br><span class="line">  age?: <span class="built_in">string</span>, <span class="comment">// 18,20</span></span><br><span class="line">  <span class="attr">page</span>: <span class="built_in">number</span>,</span><br><span class="line">  <span class="attr">size</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>js 中类似于 18,20 这样以逗号分隔字符串，会在 get 传参时转换为 java 中的整数数组</li>
</ul>
<p>编写组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;input type=&quot;text&quot; placeholder=&quot;请输入姓名&quot; v-model=&quot;dto.name&quot;&gt;</span><br><span class="line">  &lt;select v-model=&quot;dto.sex&quot;&gt;</span><br><span class="line">    &lt;option value=&quot;&quot; selected&gt;请选择性别&lt;/option&gt;</span><br><span class="line">    &lt;option value=&quot;男&quot;&gt;男&lt;/option&gt;</span><br><span class="line">    &lt;option value=&quot;女&quot;&gt;女&lt;/option&gt;</span><br><span class="line">  &lt;/select&gt;</span><br><span class="line">  &lt;input type=&quot;text&quot; placeholder=&quot;请输入年龄范围&quot; v-model=&quot;dto.age&quot;&gt;</span><br><span class="line">  &lt;br&gt;</span><br><span class="line">  &lt;input type=&quot;text&quot; placeholder=&quot;请输入页码&quot; v-model=&quot;dto.page&quot;&gt;</span><br><span class="line">  &lt;input type=&quot;text&quot; placeholder=&quot;请输入页大小&quot; v-model=&quot;dto.size&quot;&gt;</span><br><span class="line">  &lt;input type=&quot;button&quot; value=&quot;搜索&quot; @click=&quot;search&quot;&gt;</span><br><span class="line">  &lt;hr&gt;</span><br><span class="line">  &lt;h3 v-if=&quot;students.length === 0&quot;&gt;暂无数据&lt;/h3&gt;</span><br><span class="line">  &lt;ul v-else&gt;</span><br><span class="line">    &lt;li v-for=&quot;s of students&quot; :key=&quot;s.id&quot;&gt;</span><br><span class="line">      &lt;span&gt;&#123;&#123;s.name&#125;&#125;&lt;/span&gt;</span><br><span class="line">      &lt;span&gt;&#123;&#123;s.sex&#125;&#125;&lt;/span&gt;</span><br><span class="line">      &lt;span&gt;&#123;&#123;s.age&#125;&#125;&lt;/span&gt;</span><br><span class="line">    &lt;/li&gt;</span><br><span class="line">  &lt;/ul&gt;</span><br><span class="line">  &lt;hr&gt;</span><br><span class="line">  总记录数&#123;&#123;total&#125;&#125; 总页数&#123;&#123;totalPage&#125;&#125;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import axios from &quot;../api/request&quot;</span><br><span class="line">import &#123; usePagination &#125; from &#x27;vue-request&#x27;</span><br><span class="line">import &#123; computed, ref &#125; from &#x27;vue&#x27;</span><br><span class="line">import &#123; AxiosRespPage, Student, StudentQueryDto &#125; from &#x27;../model/Model8080&#x27;</span><br><span class="line"></span><br><span class="line">const dto = ref&lt;StudentQueryDto&gt;(&#123;name:&#x27;&#x27;, sex:&#x27;&#x27;, age:&#x27;&#x27;, page:1, size:5&#125;)</span><br><span class="line"></span><br><span class="line">// data 代表就是 axios 的响应对象</span><br><span class="line">// 泛型参数1: 响应类型</span><br><span class="line">// 泛型参数2: 请求类型</span><br><span class="line">const &#123; data, total, totalPage, run &#125; = usePagination&lt;AxiosRespPage&lt;Student&gt;, StudentQueryDto[]&gt;(</span><br><span class="line">  (d) =&gt; axios.get(&#x27;/api/students/q&#x27;, &#123;params: d&#125;), // 箭头函数</span><br><span class="line">  &#123;</span><br><span class="line">    defaultParams: [ dto.value ], // 默认参数, 会作为参数传递给上面的箭头函数</span><br><span class="line">    pagination: &#123;</span><br><span class="line">      currentKey: &#x27;page&#x27;, // 指明当前页属性</span><br><span class="line">      pageSizeKey: &#x27;size&#x27;, // 指明页大小属性</span><br><span class="line">      totalKey: &#x27;data.data.total&#x27; // 指明总记录数属性</span><br><span class="line">    &#125; </span><br><span class="line">  &#125; // 选项</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">const students = computed(()=&gt;&#123;</span><br><span class="line">  return data?.value?.data.data.list || []</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">function search() &#123;</span><br><span class="line">  run(dto.value) // 会作为参数传递给usePagination的箭头函数</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">ul li &#123;</span><br><span class="line">  list-style: none;</span><br><span class="line">  font-family: &quot;华文行楷&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">li span:nth-child(1) &#123;</span><br><span class="line">  font-size: 24px;</span><br><span class="line">&#125;</span><br><span class="line">li span:nth-child(2) &#123;</span><br><span class="line">  font-size: 12px;</span><br><span class="line">  color: crimson;</span><br><span class="line">  vertical-align: bottom;</span><br><span class="line">&#125;</span><br><span class="line">li span:nth-child(3) &#123;</span><br><span class="line">  font-size: 12px;</span><br><span class="line">  color: darkblue;</span><br><span class="line">  vertical-align: top;</span><br><span class="line">&#125;</span><br><span class="line">input,select &#123;</span><br><span class="line">  width: 100px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>usePagination 只需要定义一次，后续还想用它内部的 axios 发请求，只需调用 run 函数</li>
<li><br></li>
</ul>
<h2 id="子组件"><a href="#子组件" class="headerlink" title="子组件"></a>子组件</h2><p><strong>例1</strong></p>
<p>定义子组件 Child1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;card&quot;&gt;</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;p class=&quot;name&quot;&gt;&#123;&#123;name&#125;&#125;&lt;/p&gt;</span><br><span class="line">        &lt;p class=&quot;location&quot;&gt;&#123;&#123;country&#125;&#125;&lt;/p&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;img :src=&quot;avatar || &#x27;/src/assets/vue.svg&#x27;&quot;/&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 定义属性,  编译宏</span><br><span class="line">defineProps&lt;&#123;name:string,country:string,avatar?:string&#125;&gt;()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.container &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-wrap: wrap;</span><br><span class="line">  justify-content: space-evenly;</span><br><span class="line">  flex-direction: row-reverse;</span><br><span class="line">&#125;</span><br><span class="line">.name &#123;</span><br><span class="line">  font-weight: bold;</span><br><span class="line">&#125;</span><br><span class="line">.location &#123;</span><br><span class="line">  font-size: 0.8em;</span><br><span class="line">  color: #6d597a;</span><br><span class="line">&#125;</span><br><span class="line">.card &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: space-evenly;</span><br><span class="line">  padding: 1em;</span><br><span class="line">  margin: 1rem;</span><br><span class="line">  border-radius: 5px;</span><br><span class="line">  background: #fff;</span><br><span class="line">  width: 200px;</span><br><span class="line">  box-shadow: 0 14px 28px rgba(0, 0, 0, 0.25), 0 10px 10px rgba(0, 0, 0, 0.22);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.card:hover &#123;</span><br><span class="line">  transform: rotate(-5deg);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.card img &#123;</span><br><span class="line">  margin-left: 1em;</span><br><span class="line">  border-radius: 50%;</span><br><span class="line">  max-width: 55px;</span><br><span class="line">  max-height: 55px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>父组件引用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;Child1 name=&quot;张三&quot; country=&quot;中国&quot; avatar=&quot;/src/assets/vue.svg&quot;&gt;&lt;/Child1&gt;</span><br><span class="line">  &lt;Child1 name=&quot;李四&quot; country=&quot;印度&quot; avatar=&quot;/vite.svg&quot;&gt;&lt;/Child1&gt;</span><br><span class="line">  &lt;Child1 name=&quot;王五&quot; country=&quot;韩国&quot; &gt;&lt;/Child1&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">import Child1 from &#x27;../components/Child1.vue&#x27;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p><br></p>
<p><strong>例2</strong></p>
<p>首先添加类型说明 model/ModelRandomUser.ts</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AxiosResponse</span> &#125; <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">AxiosRespResults</span> <span class="keyword">extends</span> <span class="title class_">AxiosResponse</span>&lt;<span class="title class_">Results</span>&gt;&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">Results</span> &#123;</span><br><span class="line">  <span class="attr">info</span>: &#123;</span><br><span class="line">    <span class="attr">page</span>: <span class="built_in">number</span>,</span><br><span class="line">    <span class="attr">results</span>: <span class="built_in">number</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">results</span>: <span class="title class_">Result</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">Result</span> &#123;</span><br><span class="line">  <span class="attr">gender</span>: <span class="string">&#x27;male&#x27;</span> | <span class="string">&#x27;female&#x27;</span>,</span><br><span class="line">  <span class="attr">name</span>: &#123;</span><br><span class="line">    <span class="attr">first</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">last</span>: <span class="built_in">string</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">location</span>: &#123;</span><br><span class="line">    <span class="attr">country</span>: <span class="built_in">string</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">picture</span>: &#123;</span><br><span class="line">    <span class="attr">medium</span>: <span class="built_in">string</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">login</span>: &#123;</span><br><span class="line">    <span class="attr">username</span>: <span class="built_in">string</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>子组件不变，父组件使用子组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 父组件 --&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;Child1 v-for=&quot;u of users&quot; </span><br><span class="line">    :name=&quot;u.name.first&quot; </span><br><span class="line">    :country=&quot;u.location.country&quot; </span><br><span class="line">    :avatar=&quot;u.picture.medium&quot;</span><br><span class="line">    :key=&quot;u.login.username&quot;&gt;&lt;/Child1&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import axios from &quot;axios&quot;;</span><br><span class="line">import &#123; useRequest &#125; from &quot;vue-request&quot;;</span><br><span class="line">import &#123; computed &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; AxiosRespResults &#125; from &#x27;../model/ModelRandomUser&#x27;</span><br><span class="line">import Child1 from &quot;../components/Child1.vue&quot;;</span><br><span class="line"></span><br><span class="line">const &#123; data &#125; = useRequest&lt;AxiosRespResults&gt;(</span><br><span class="line">  ()=&gt;axios.get(&#x27;https://randomuser.me/api/?results=3&#x27;)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">const users = computed(()=&gt;&#123;</span><br><span class="line">  return data.value?.data.results || []</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>如果觉得 Result 数据结构嵌套太复杂，还可以做一个类型映射</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 父组件 --&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;Child1 v-for=&quot;u of users&quot; </span><br><span class="line">    :name=&quot;u.name&quot; </span><br><span class="line">    :country=&quot;u.country&quot; </span><br><span class="line">    :avatar=&quot;u.avatar&quot;</span><br><span class="line">    :key=&quot;u.username&quot;&gt;&lt;/Child1&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import axios from &quot;axios&quot;;</span><br><span class="line">import &#123; useRequest &#125; from &quot;vue-request&quot;;</span><br><span class="line">import &#123; computed &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; AxiosRespResults, Result &#125; from &#x27;../model/ModelRandomUser&#x27;</span><br><span class="line">import Child1 from &quot;../components/Child1.vue&quot;;</span><br><span class="line"></span><br><span class="line">const &#123; data &#125; = useRequest&lt;AxiosRespResults&gt;(</span><br><span class="line">  ()=&gt;axios.get(&#x27;https://randomuser.me/api/?results=3&#x27;)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">const users = computed(()=&gt;&#123;</span><br><span class="line">  return data.value?.data.results.map(resultToUser) || []</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">interface User &#123;</span><br><span class="line">  name: string,</span><br><span class="line">  country: string,</span><br><span class="line">  avatar: string,</span><br><span class="line">  username: string</span><br><span class="line">&#125;</span><br><span class="line">function resultToUser(r:Result):User &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    name: r.name.first,</span><br><span class="line">    country: r.location.country,</span><br><span class="line">    avatar: r.picture.medium,</span><br><span class="line">    username: r.login.username</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>resultToUser 将 Result 类型映射为 User 类型</li>
</ul>
<p><br></p>
<h1 id="Antdv"><a href="#Antdv" class="headerlink" title="Antdv"></a>Antdv</h1><p>添加必要插件</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install ant-design-vue</span><br></pre></td></tr></table></figure>
<ul>
<li>ant-design-vue 组件库插件</li>
</ul>
<p>引入 antdv 功能，修改 main.ts</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./style.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> antd <span class="keyword">from</span> <span class="string">&#x27;ant-design-vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;ant-design-vue/dist/antd.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">createApp</span>(<span class="title class_">App</span>).<span class="title function_">use</span>(antd).<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="表格"><a href="#表格" class="headerlink" title="表格"></a>表格</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- &lt;a-table :columns=&quot;columns&quot; :dataSource=&quot;students&quot; rowKey=&quot;id&quot;&gt;&lt;/a-table&gt; --&gt;</span><br><span class="line">  &lt;a-table :columns=&quot;columns&quot; :dataSource=&quot;students&quot; :rowKey=&quot;rowKey&quot;&gt;&lt;/a-table&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import axios from &quot;../api/request&quot;;</span><br><span class="line">import &#123; ref, computed &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; useRequest &#125; from &quot;vue-request&quot;;</span><br><span class="line">import &#123; AxiosRespList, Student &#125; from &quot;../model/Model8080&quot;;</span><br><span class="line"></span><br><span class="line">const &#123;data&#125; = useRequest&lt;AxiosRespList&lt;Student&gt;&gt;(</span><br><span class="line">  ()=&gt;axios.get(&#x27;/api/students&#x27;)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">const students = computed(()=&gt;&#123;</span><br><span class="line">  return data.value?.data.data || []</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">function rowKey(r:Student) &#123;</span><br><span class="line">  return r.id</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const columns = ref([</span><br><span class="line">  &#123;</span><br><span class="line">    title:&#x27;编号&#x27;,</span><br><span class="line">    dataIndex:&#x27;id&#x27;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    title:&#x27;姓名&#x27;,</span><br><span class="line">    dataIndex:&#x27;name&#x27;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    title:&#x27;性别&#x27;,</span><br><span class="line">    dataIndex:&#x27;sex&#x27;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    title:&#x27;年龄&#x27;,</span><br><span class="line">    dataIndex:&#x27;age&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">])</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="分页"><a href="#分页" class="headerlink" title="分页"></a>分页</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;a-table :columns=&quot;columns&quot; :data-source=&quot;students&quot; row-key=&quot;id&quot;</span><br><span class="line">   :pagination=&quot;pagination&quot; @change=&quot;tableChange&quot;&gt;&lt;/a-table&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import axios from &quot;../api/request&quot;;</span><br><span class="line">import &#123; ref, computed &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; usePagination &#125; from &quot;vue-request&quot;;</span><br><span class="line">import &#123; AxiosRespPage, Student, StudentQueryDto &#125; from &quot;../model/Model8080&quot;;</span><br><span class="line">import &#123; PaginationProps &#125; from &quot;ant-design-vue&quot;;</span><br><span class="line">import DateBody from &quot;ant-design-vue/lib/vc-picker/panels/DatePanel/DateBody&quot;;</span><br><span class="line"></span><br><span class="line">const dto = ref(&#123;page: 1, size: 5&#125;)</span><br><span class="line"></span><br><span class="line">const &#123;data, total, run&#125; = usePagination&lt;AxiosRespPage&lt;Student&gt;, StudentQueryDto[]&gt;(</span><br><span class="line">  (d)=&gt; axios.get(&#x27;/api/students/q&#x27;, &#123;params:d&#125;),</span><br><span class="line">  &#123;</span><br><span class="line">    defaultParams: [dto.value],</span><br><span class="line">    pagination: &#123;</span><br><span class="line">      currentKey: &quot;page&quot;,</span><br><span class="line">      pageSizeKey: &#x27;size&#x27;,</span><br><span class="line">      totalKey: &#x27;data.data.total&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// 在页号或页大小改变时调用</span><br><span class="line">function tableChange(pagination: PaginationProps) &#123; </span><br><span class="line">  console.log(pagination)</span><br><span class="line">  dto.value.page = pagination.current ?? 1</span><br><span class="line">  dto.value.size = pagination.pageSize ?? 5</span><br><span class="line">  run(dto.value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const pagination = computed&lt;PaginationProps&gt;(()=&gt;&#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    current: dto.value.page, // 当前页</span><br><span class="line">    pageSize: dto.value.size, // 页大小</span><br><span class="line">    total: total.value,       // 总记录数</span><br><span class="line">    showSizeChanger: true,    // 显示页大小的下拉列表</span><br><span class="line">    pageSizeOptions: [&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;] // 自定义下拉列表内容</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">const students = computed(()=&gt;&#123;</span><br><span class="line">  return data.value?.data.data.list || []</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">const columns = ref([</span><br><span class="line">  &#123;</span><br><span class="line">    title: &quot;编号&quot;,</span><br><span class="line">    dataIndex: &quot;id&quot;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    title: &quot;姓名&quot;,</span><br><span class="line">    dataIndex: &quot;name&quot;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    title: &quot;性别&quot;,</span><br><span class="line">    dataIndex: &quot;sex&quot;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    title: &quot;年龄&quot;,</span><br><span class="line">    dataIndex: &quot;age&quot;,</span><br><span class="line">  &#125;,</span><br><span class="line">]);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="搜索、删除"><a href="#搜索、删除" class="headerlink" title="搜索、删除"></a>搜索、删除</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;a-row&gt;</span><br><span class="line">    &lt;a-col :span=&quot;2&quot;&gt;</span><br><span class="line">      &lt;a-button type=&quot;primary&quot; size=&quot;small&quot;&gt;新增&lt;/a-button&gt;</span><br><span class="line">    &lt;/a-col&gt;</span><br><span class="line">    &lt;a-col :span=&quot;4&quot;&gt;</span><br><span class="line">      &lt;a-popconfirm title=&quot;确认要删除选中学生吗?&quot;</span><br><span class="line">        ok-text=&quot;确定&quot; cancel-text=&quot;取消&quot; @confirm=&quot;onDeleteIds&quot;</span><br><span class="line">        @visibleChange=&quot;onVisibleChange&quot; :visible=&quot;visible&quot;&gt;</span><br><span class="line">        &lt;a-button type=&quot;primary&quot; size=&quot;small&quot;&gt;删除选中&lt;/a-button&gt;</span><br><span class="line">      &lt;/a-popconfirm&gt;</span><br><span class="line">    &lt;/a-col&gt;</span><br><span class="line">    &lt;a-col :span=&quot;4&quot;&gt;</span><br><span class="line">    &lt;/a-col&gt;</span><br><span class="line">    &lt;a-col :span=&quot;4&quot;&gt;</span><br><span class="line">      &lt;a-input v-model:value=&quot;dto.name&quot; placeholder=&quot;输姓名&quot; size=&quot;small&quot;&gt;&lt;/a-input&gt;</span><br><span class="line">    &lt;/a-col&gt;</span><br><span class="line">    &lt;a-col :span=&quot;4&quot;&gt;</span><br><span class="line">      &lt;a-select v-model:value=&quot;dto.sex&quot; placeholder=&quot;选性别&quot; :allowClear=&quot;true&quot; size=&quot;small&quot;&gt;</span><br><span class="line">        &lt;a-select-option value=&quot;男&quot;&gt;男&lt;/a-select-option&gt;</span><br><span class="line">        &lt;a-select-option value=&quot;女&quot;&gt;女&lt;/a-select-option&gt;</span><br><span class="line">      &lt;/a-select&gt;</span><br><span class="line">    &lt;/a-col&gt;</span><br><span class="line">    &lt;a-col :span=&quot;4&quot;&gt;</span><br><span class="line">      &lt;a-select v-model:value=&quot;dto.age&quot; placeholder=&quot;选年龄&quot; :allowClear=&quot;true&quot; size=&quot;small&quot;&gt;</span><br><span class="line">        &lt;a-select-option value=&quot;0,20&quot;&gt;20以下&lt;/a-select-option&gt;</span><br><span class="line">        &lt;a-select-option value=&quot;21,30&quot;&gt;21~30&lt;/a-select-option&gt;</span><br><span class="line">        &lt;a-select-option value=&quot;31,40&quot;&gt;31~40&lt;/a-select-option&gt;</span><br><span class="line">        &lt;a-select-option value=&quot;40,120&quot;&gt;40以上&lt;/a-select-option&gt;</span><br><span class="line">      &lt;/a-select&gt;</span><br><span class="line">    &lt;/a-col&gt;</span><br><span class="line">    &lt;a-col :span=&quot;2&quot;&gt;</span><br><span class="line">      &lt;a-button @click=&quot;tableChange&quot; type=&quot;primary&quot; size=&quot;small&quot;&gt;搜索&lt;/a-button&gt;</span><br><span class="line">    &lt;/a-col&gt;</span><br><span class="line">  &lt;/a-row&gt;</span><br><span class="line">  &lt;hr&gt;</span><br><span class="line">  &lt;a-table :columns=&quot;columns&quot; :data-source=&quot;students&quot; row-key=&quot;id&quot;</span><br><span class="line">    :pagination=&quot;pagination&quot; @change=&quot;tableChange&quot;</span><br><span class="line">    :row-selection=&quot;&#123;selectedRowKeys:ids,onChange:onSelectChange&#125;&quot;&gt;</span><br><span class="line">    &lt;template #bodyCell=&quot;&#123;column, record&#125;&quot;&gt;</span><br><span class="line">      &lt;template v-if=&quot;column.dataIndex===&#x27;name&#x27;&quot;&gt;</span><br><span class="line">      &#123;&#123;record.name + (record.sex===&#x27;男&#x27;?&#x27;(大侠)&#x27;:&#x27;(女侠)&#x27;)&#125;&#125;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line"></span><br><span class="line">      &lt;template v-else-if=&quot;column.dataIndex===&#x27;operation&#x27;&quot;&gt;</span><br><span class="line">      &lt;a&gt;修改&lt;/a&gt;</span><br><span class="line">      &lt;a-divider type=&quot;vertical&quot;&gt;&lt;/a-divider&gt;</span><br><span class="line">      &lt;a-popconfirm title=&quot;确认要删除该学生吗?&quot;</span><br><span class="line">        ok-text=&quot;确定&quot; cancel-text=&quot;取消&quot; @confirm=&quot;onDelete(record.id)&quot;&gt;</span><br><span class="line">        &lt;a&gt;删除&lt;/a&gt;   </span><br><span class="line">      &lt;/a-popconfirm&gt;         </span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/a-table&gt;</span><br><span class="line">  </span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import axios from &quot;../api/request&quot;;</span><br><span class="line">import &#123; ref, computed &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; usePagination, useRequest &#125; from &quot;vue-request&quot;;</span><br><span class="line">import &#123; AxiosRespPage, AxiosRespString, Student, StudentQueryDto &#125; from &quot;../model/Model8080&quot;;</span><br><span class="line">import &#123; PaginationProps &#125; from &quot;ant-design-vue&quot;;</span><br><span class="line"></span><br><span class="line">// &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 搜索功能开始</span><br><span class="line">const dto = ref(&#123;page: 1, size: 5, name: &#x27;&#x27;, sex: null, age: null&#125;)</span><br><span class="line"></span><br><span class="line">const &#123;data, total, run: search&#125; = usePagination&lt;AxiosRespPage&lt;Student&gt;, StudentQueryDto[]&gt;(</span><br><span class="line">  (d) =&gt; axios.get(&#x27;/api/students/q&#x27;, &#123;params:d&#125;),</span><br><span class="line">  &#123;</span><br><span class="line">    defaultParams: [dto.value],</span><br><span class="line">    pagination: &#123;</span><br><span class="line">      currentKey: &quot;page&quot;,</span><br><span class="line">      pageSizeKey: &#x27;size&#x27;,</span><br><span class="line">      totalKey: &#x27;data.data.total&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">function tableChange(pagination: PaginationProps) &#123; </span><br><span class="line">  // console.log(pagination)</span><br><span class="line">  dto.value.page = pagination.current ?? 1</span><br><span class="line">  dto.value.size = pagination.pageSize ?? 5</span><br><span class="line">  search(dto.value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const pagination = computed&lt;PaginationProps&gt;(()=&gt;&#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    current: dto.value.page, // 当前页</span><br><span class="line">    pageSize: dto.value.size, // 页大小</span><br><span class="line">    total: total.value,       // 总记录数</span><br><span class="line">    showSizeChanger: true,    // 显示页大小的下拉列表</span><br><span class="line">    pageSizeOptions: [&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;] // 自定义下拉列表内容</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">const students = computed(()=&gt;&#123;</span><br><span class="line">  return data.value?.data.data.list || []</span><br><span class="line">&#125;)</span><br><span class="line">// &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; 搜索功能结束</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 删除功能开始</span><br><span class="line">async function onDelete(id:number) &#123;</span><br><span class="line">  // console.log(&quot;学生id是:&quot;+id)</span><br><span class="line">  await deleteById(id)      // 删除请求 删除响应</span><br><span class="line">  search(dto.value)        //                   查询请求 查询响应</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const &#123; runAsync: deleteById &#125; = useRequest&lt;AxiosRespString, number[]&gt;(</span><br><span class="line">  (id) =&gt; axios.delete(`/api/students/$&#123;id&#125;`),</span><br><span class="line">  &#123;</span><br><span class="line">    manual: true</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line">// &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; 删除功能结束</span><br><span class="line"></span><br><span class="line">// &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 删除选中开始</span><br><span class="line">const ids = ref&lt;number[]&gt;([])</span><br><span class="line"></span><br><span class="line">function onSelectChange(keys:number[]) &#123;</span><br><span class="line">  // console.log(keys)</span><br><span class="line">  ids.value = keys</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">async function onDeleteIds() &#123;</span><br><span class="line">  await deleteByIds(ids.value)</span><br><span class="line">  ids.value = []</span><br><span class="line">  search(dto.value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const &#123; runAsync: deleteByIds &#125; = useRequest&lt;AxiosRespString, number[][]&gt;(</span><br><span class="line">  (ids)=&gt;axios.delete(&#x27;/api/students&#x27;, &#123;data: ids&#125;),</span><br><span class="line">  &#123;</span><br><span class="line">    manual: true</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">const visible = ref(false)</span><br><span class="line"></span><br><span class="line">function onVisibleChange(v:boolean) &#123;</span><br><span class="line">  if(!v) &#123; // 希望隐藏</span><br><span class="line">    visible.value = false</span><br><span class="line">  &#125; else &#123; // 希望显示</span><br><span class="line">    visible.value = ids.value.length &gt; 0</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">// &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; 删除选中结束</span><br><span class="line"></span><br><span class="line">const columns = ref([</span><br><span class="line">  &#123;</span><br><span class="line">    title: &quot;编号&quot;,</span><br><span class="line">    dataIndex: &quot;id&quot;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    title: &quot;姓名&quot;,</span><br><span class="line">    dataIndex: &quot;name&quot;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    title: &quot;性别&quot;,</span><br><span class="line">    dataIndex: &quot;sex&quot;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    title: &quot;年龄&quot;,</span><br><span class="line">    dataIndex: &quot;age&quot;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    title: &#x27;操作&#x27;,</span><br><span class="line">    dataIndex: &#x27;operation&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">]);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">  .ant-input, .ant-select &#123;</span><br><span class="line">    width: 80px;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="新增、修改"><a href="#新增、修改" class="headerlink" title="新增、修改"></a>新增、修改</h2><p>子组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;a-modal :visible=&quot;visible&quot; :title=&quot;title&quot; </span><br><span class="line">    @ok=&quot;onOk&quot; @cancel=&quot;onCancel&quot;&gt;</span><br><span class="line">    &lt;a-form&gt;</span><br><span class="line">      &lt;a-form-item label=&quot;编号&quot; v-if=&quot;id&quot;&gt;</span><br><span class="line">        &lt;a-input readonly v-model:value=&quot;id&quot;&gt;&lt;/a-input&gt;</span><br><span class="line">      &lt;/a-form-item&gt;</span><br><span class="line">      &lt;a-form-item label=&quot;姓名&quot;&gt;</span><br><span class="line">        &lt;a-input v-model:value=&quot;dto.name&quot;&gt;&lt;/a-input&gt;</span><br><span class="line">      &lt;/a-form-item&gt;</span><br><span class="line">      &lt;a-form-item label=&quot;性别&quot;&gt;</span><br><span class="line">        &lt;a-radio-group v-model:value=&quot;dto.sex&quot;&gt;</span><br><span class="line">          &lt;a-radio-button value=&quot;男&quot;&gt;男&lt;/a-radio-button&gt;</span><br><span class="line">          &lt;a-radio-button value=&quot;女&quot;&gt;女&lt;/a-radio-button&gt;</span><br><span class="line">        &lt;/a-radio-group&gt;</span><br><span class="line">      &lt;/a-form-item&gt;</span><br><span class="line">      &lt;a-form-item label=&quot;年龄&quot;&gt;</span><br><span class="line">        &lt;a-input-number v-model:value=&quot;dto.age&quot;&gt;&lt;/a-input-number&gt;</span><br><span class="line">      &lt;/a-form-item&gt;</span><br><span class="line">    &lt;/a-form&gt;</span><br><span class="line">  &lt;/a-modal&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import axios from &quot;../api/request&quot;;</span><br><span class="line">import &#123; ref, computed &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; useRequest &#125; from &quot;vue-request&quot;;</span><br><span class="line">import &#123; StudentSaveDto, AxiosRespString &#125; from &quot;../model/Model8080&quot;;</span><br><span class="line">import &#123; Form &#125; from &#x27;ant-design-vue&#x27;</span><br><span class="line"></span><br><span class="line">// 定义属性</span><br><span class="line">const props = defineProps&lt;&#123;id:number, dto:StudentSaveDto, visible:boolean&#125;&gt;()</span><br><span class="line"></span><br><span class="line">const title = computed(()=&gt; props.id===0?&#x27;新增学生&#x27;:&#x27;修改学生&#x27;)</span><br><span class="line"></span><br><span class="line">// 定义事件</span><br><span class="line">const emit = defineEmits([&#x27;update:visible&#x27;, &#x27;saved&#x27;])</span><br><span class="line"></span><br><span class="line">async function onOk() &#123;</span><br><span class="line">  if(props.id === 0) &#123;</span><br><span class="line">    await insert(props.dto)</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    await update(props.dto)</span><br><span class="line">  &#125;</span><br><span class="line">  emit(&#x27;saved&#x27;)</span><br><span class="line">  // 发送事件给父组件, 希望把 visible 改为 false</span><br><span class="line">  emit(&#x27;update:visible&#x27;, false) </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function onCancel() &#123;</span><br><span class="line">  // 发送事件给父组件, 希望把 visible 改为 false</span><br><span class="line">  emit(&#x27;update:visible&#x27;, false)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const &#123;runAsync:insert&#125; = useRequest&lt;AxiosRespString,StudentSaveDto[]&gt;(</span><br><span class="line">  (dto)=&gt;axios.post(&#x27;/api/students&#x27;, dto),</span><br><span class="line">  &#123;</span><br><span class="line">    manual: true</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">const &#123;runAsync:update&#125; = useRequest&lt;AxiosRespString,StudentSaveDto[]&gt;(</span><br><span class="line">  (dto)=&gt;axios.put(`/api/students/$&#123;props.id&#125;`, dto),</span><br><span class="line">  &#123;</span><br><span class="line">    manual: true</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>父组件使用子组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;A4Save :id=&quot;id&quot; :dto=&quot;saveDto&quot; v-model:visible=&quot;saveVisible&quot;&gt;&lt;/A4Save&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// ...</span><br><span class="line">// &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 新增、修改开始</span><br><span class="line">const saveVisible = ref(false)</span><br><span class="line">const id = ref(0)</span><br><span class="line">const saveDto = reactive(&#123;name:&#x27;&#x27;, sex:&#x27;男&#x27;, age:18&#125;)</span><br><span class="line"></span><br><span class="line">function onInsert() &#123;</span><br><span class="line">  saveVisible.value = true</span><br><span class="line">  id.value = 0</span><br><span class="line">  Object.assign(saveDto, &#123;name:&#x27;&#x27;, sex:&#x27;男&#x27;, age:18&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function onUpdate(record: Student) &#123;</span><br><span class="line">  saveVisible.value = true</span><br><span class="line">  id.value = record.id</span><br><span class="line">  Object.assign(saveDto, record)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function onSaved() &#123;</span><br><span class="line">  search(dto.value)</span><br><span class="line">&#125;    </span><br><span class="line">// &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; 新增、修改结束</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>saveDto 使用 reactive 包装，是为了解决后续表单校验失效问题</p>
</li>
<li><p>Object.assign 是将源对象（参数2）的属性值赋值给目标对象（参数1）的同名属性，效果等价于</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">saveDto.<span class="property">name</span> = record.<span class="property">name</span></span><br><span class="line">saveDto.<span class="property">sex</span> = record.<span class="property">sex</span></span><br><span class="line">saveDto.<span class="property">age</span> = record.<span class="property">age</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br></p>
<h2 id="全局消息"><a href="#全局消息" class="headerlink" title="全局消息"></a>全局消息</h2><p>在 request.ts 中对响应消息统一处理</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; message &#125; <span class="keyword">from</span> <span class="string">&#x27;ant-design-vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="comment">// 响应拦截器</span></span><br><span class="line">_axios.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">response</span>)=&gt;</span>&#123; <span class="comment">// 状态码  2xx</span></span><br><span class="line">    <span class="keyword">if</span>(response.<span class="property">data</span>.<span class="property">message</span>) &#123;</span><br><span class="line">      message.<span class="title function_">success</span>(response.<span class="property">data</span>.<span class="property">message</span>, <span class="number">3</span>)</span><br><span class="line">    &#125;    </span><br><span class="line">    <span class="comment">// ... </span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">error</span>)=&gt;</span>&#123; <span class="comment">// 状态码 &gt; 2xx, 400,401,403,404,500</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h2 id="表单校验"><a href="#表单校验" class="headerlink" title="表单校验"></a>表单校验</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;a-modal :visible=&quot;visible&quot; :title=&quot;title&quot; </span><br><span class="line">    @ok=&quot;onOk&quot; @cancel=&quot;onCancel&quot;&gt;</span><br><span class="line">    &lt;a-form&gt;</span><br><span class="line">      &lt;a-form-item label=&quot;编号&quot; v-if=&quot;id&quot;&gt;</span><br><span class="line">        &lt;a-input readonly v-model:value=&quot;id&quot;&gt;&lt;/a-input&gt;</span><br><span class="line">      &lt;/a-form-item&gt;</span><br><span class="line">      &lt;a-form-item label=&quot;姓名&quot; v-bind=&quot;validateInfos.name&quot;&gt;</span><br><span class="line">        &lt;a-input v-model:value=&quot;dto.name&quot;&gt;&lt;/a-input&gt;</span><br><span class="line">      &lt;/a-form-item&gt;</span><br><span class="line">      &lt;a-form-item label=&quot;性别&quot; v-bind=&quot;validateInfos.sex&quot;&gt;</span><br><span class="line">        &lt;a-radio-group v-model:value=&quot;dto.sex&quot;&gt;</span><br><span class="line">          &lt;a-radio-button value=&quot;男&quot;&gt;男&lt;/a-radio-button&gt;</span><br><span class="line">          &lt;a-radio-button value=&quot;女&quot;&gt;女&lt;/a-radio-button&gt;</span><br><span class="line">        &lt;/a-radio-group&gt;</span><br><span class="line">      &lt;/a-form-item&gt;</span><br><span class="line">      &lt;a-form-item label=&quot;年龄&quot; v-bind=&quot;validateInfos.age&quot;&gt;</span><br><span class="line">        &lt;a-input-number v-model:value=&quot;dto.age&quot;&gt;&lt;/a-input-number&gt;</span><br><span class="line">      &lt;/a-form-item&gt;</span><br><span class="line">    &lt;/a-form&gt;</span><br><span class="line">  &lt;/a-modal&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import axios from &quot;../api/request&quot;;</span><br><span class="line">import &#123; ref, computed &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; useRequest &#125; from &quot;vue-request&quot;;</span><br><span class="line">import &#123; StudentSaveDto, AxiosRespString &#125; from &quot;../model/Model8080&quot;;</span><br><span class="line">import &#123; Form &#125; from &#x27;ant-design-vue&#x27;</span><br><span class="line"></span><br><span class="line">// 定义属性</span><br><span class="line">const props = defineProps&lt;&#123;id:number, dto:StudentSaveDto, visible:boolean&#125;&gt;()</span><br><span class="line"></span><br><span class="line">const title = computed(()=&gt; props.id===0?&#x27;新增学生&#x27;:&#x27;修改学生&#x27;)</span><br><span class="line"></span><br><span class="line">// 定义事件</span><br><span class="line">const emit = defineEmits([&#x27;update:visible&#x27;, &#x27;saved&#x27;])</span><br><span class="line"></span><br><span class="line">async function onOk() &#123;</span><br><span class="line">  try &#123;</span><br><span class="line">    // 提交前校验</span><br><span class="line">    await validate()</span><br><span class="line">    if(props.id === 0) &#123;</span><br><span class="line">      await insert(props.dto)</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      await update(props.dto)</span><br><span class="line">    &#125;</span><br><span class="line">    emit(&#x27;saved&#x27;)</span><br><span class="line">    // 发送事件给父组件, 希望把 visible 改为 false</span><br><span class="line">    emit(&#x27;update:visible&#x27;, false) </span><br><span class="line">  &#125; catch (e) &#123;</span><br><span class="line">    console.error(e)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function onCancel() &#123;</span><br><span class="line">  // 发送事件给父组件, 希望把 visible 改为 false</span><br><span class="line">  emit(&#x27;update:visible&#x27;, false)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const &#123;runAsync:insert&#125; = useRequest&lt;AxiosRespString,StudentSaveDto[]&gt;(</span><br><span class="line">  (dto)=&gt;axios.post(&#x27;/api/students&#x27;, dto),</span><br><span class="line">  &#123;</span><br><span class="line">    manual: true</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">const &#123;runAsync:update&#125; = useRequest&lt;AxiosRespString,StudentSaveDto[]&gt;(</span><br><span class="line">  (dto)=&gt;axios.put(`/api/students/$&#123;props.id&#125;`, dto),</span><br><span class="line">  &#123;</span><br><span class="line">    manual: true</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">const rules = ref(&#123;</span><br><span class="line">  name: [</span><br><span class="line">    &#123;required: true, message:&#x27;姓名必须&#x27;&#125;,</span><br><span class="line">    &#123;min:2, message:&#x27;字符数至少为2&#x27;&#125;</span><br><span class="line">  ],</span><br><span class="line">  sex: [</span><br><span class="line">    &#123;required: true, message:&#x27;性别必须&#x27;&#125;</span><br><span class="line">  ],</span><br><span class="line">  age: [</span><br><span class="line">    &#123;required: true, message:&#x27;年龄必须&#x27;&#125;,</span><br><span class="line">    &#123;min:10, message:&#x27;年龄最小为10岁&#x27;, type:&#x27;number&#x27;&#125;,</span><br><span class="line">    &#123;max:120, message:&#x27;年龄最大为120岁&#x27;, type:&#x27;number&#x27;&#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 参数1: 待校验的数据</span><br><span class="line">// 参数2: 校验规则</span><br><span class="line">const &#123; validateInfos, validate &#125; = Form.useForm(props.dto, rules)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p><br></p>
<h1 id="vue-router"><a href="#vue-router" class="headerlink" title="vue-router"></a>vue-router</h1><p>安装</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vue-router@<span class="number">4</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="创建-router"><a href="#创建-router" class="headerlink" title="创建 router"></a>创建 router</h2><p>首先创建一个 /src/router/a5router.ts 文件，在其中定义路由</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createRouter, createWebHashHistory&#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="variable constant_">A51</span> <span class="keyword">from</span> <span class="string">&#x27;../views/A51.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="variable constant_">A52</span> <span class="keyword">from</span> <span class="string">&#x27;../views/A52.vue&#x27;</span></span><br><span class="line"><span class="comment">// 路由 =&gt; 路径和组件之间的对应关系</span></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/a1&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="variable constant_">A51</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/a2&#x27;</span>, </span><br><span class="line">    <span class="attr">component</span>: <span class="variable constant_">A52</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123; </span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHashHistory</span>(), <span class="comment">// 路径格式</span></span><br><span class="line">  <span class="attr">routes</span>: routes <span class="comment">// 路由数组</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure>
<ul>
<li><p>createWebHashHistory 是用 # 符号作为【单页面】跳转技术，上面两个路由访问时路径格式为</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://localhost:7070/#/a1">http://localhost:7070/#/a1</a></li>
<li><a target="_blank" rel="noopener" href="http://localhost:7070/#/a2">http://localhost:7070/#/a2</a></li>
</ul>
</li>
<li><p>每个路由都有两个必须属性</p>
<ul>
<li><p>path：路径</p>
</li>
<li><p>component：组件</p>
</li>
</ul>
</li>
<li><p>createRouter 用来创建 router 对象，作为默认导出</p>
</li>
</ul>
<p>需要在 main.ts 中导入 router 对象：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">import</span> <span class="variable constant_">A5</span> <span class="keyword">from</span> <span class="string">&#x27;./views/A5.vue&#x27;</span>  <span class="comment">// vue-router</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;./router/a5router&#x27;</span></span><br><span class="line"><span class="title function_">createApp</span>(<span class="variable constant_">A5</span>).<span class="title function_">use</span>(antdv).<span class="title function_">use</span>(router).<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>A5 是根组件，不必在 router 中定义，但需要在其中定义 router-view，用来控制路由跳转后，A51、A52 这些组件的显示位置，内容如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;a5&quot;&gt;</span><br><span class="line">    &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="动态导入"><a href="#动态导入" class="headerlink" title="动态导入"></a>动态导入</h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createRouter, createWebHashHistory&#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="variable constant_">A51</span> <span class="keyword">from</span> <span class="string">&#x27;../views/A51.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="variable constant_">A52</span> <span class="keyword">from</span> <span class="string">&#x27;../views/A52.vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/a3&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;../views/A53.vue&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<ul>
<li>用 import 关键字导入，效果是打包时会将组件的 js 代码都打包成一个大的 js 文件，如果组件非常多，会影响页面加载速度</li>
<li>而 import 函数导入（动态导入），则是按需加载，即<ul>
<li>当路由跳转到 /a3 路径时，才会去加载 A53 组件对应的 js 代码</li>
<li>vue-router 官方推荐采用动态导入</li>
</ul>
</li>
</ul>
<p><br></p>
<h2 id="嵌套路由"><a href="#嵌套路由" class="headerlink" title="嵌套路由"></a>嵌套路由</h2><p>如果希望再嵌套更深层次的路由跳转，例如：希望在 A53 组件内再进行路由跳转</p>
<p>首先，修改 A53.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;a53&quot;&gt;</span><br><span class="line">    &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<p>其次，再修改 /src/router/a5router.ts 文件 内容</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createRouter, createWebHashHistory&#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="variable constant_">A51</span> <span class="keyword">from</span> <span class="string">&#x27;../views/A51.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="variable constant_">A52</span> <span class="keyword">from</span> <span class="string">&#x27;../views/A52.vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/a3&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;../views/A53.vue&#x27;</span>),</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;student&#x27;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;../views/A531.vue&#x27;</span>)</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;teacher&#x27;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;../views/A532.vue&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h2><p>用法1</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createRouter, createWebHashHistory&#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="variable constant_">A51</span> <span class="keyword">from</span> <span class="string">&#x27;../views/A51.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="variable constant_">A52</span> <span class="keyword">from</span> <span class="string">&#x27;../views/A52.vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/a3&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;../views/A53.vue&#x27;</span>),</span><br><span class="line">    <span class="attr">redirect</span>: <span class="string">&#x27;/a3/student&#x27;</span>, <span class="comment">// 重定向到另外路径</span></span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;student&#x27;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;../views/A531.vue&#x27;</span>)</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;teacher&#x27;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;../views/A532.vue&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>
<p>效果是，页面输入 /a3，紧接着会重定向跳转到 /a3/student</p>
<p>用法2</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createRouter, createWebHashHistory&#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="variable constant_">A51</span> <span class="keyword">from</span> <span class="string">&#x27;../views/A51.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="variable constant_">A52</span> <span class="keyword">from</span> <span class="string">&#x27;../views/A52.vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/a1&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="variable constant_">A51</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/a2&#x27;</span>, </span><br><span class="line">    <span class="attr">component</span>: <span class="variable constant_">A52</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/:pathMatcher(.*)*&#x27;</span>, <span class="comment">// 可以匹配剩余的路径</span></span><br><span class="line">    <span class="attr">redirect</span>: <span class="string">&#x27;/a2&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>
<p>效果是，当页面输入一个不存在路径 /aaa 时，会被 <code>path: &#39;/:pathMatcher(.*)*&#39;</code> 匹配到，然后重定向跳转到 A52 组件去</p>
<p><br></p>
<h2 id="主页布局"><a href="#主页布局" class="headerlink" title="主页布局"></a>主页布局</h2><p>借助 antdv 的 layout 组件，可以实现主页【上】【左】【右】布局</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;a53&quot;&gt;</span><br><span class="line">    &lt;a-layout&gt;</span><br><span class="line">      &lt;a-layout-header&gt;&lt;/a-layout-header&gt;</span><br><span class="line">      &lt;a-layout&gt;</span><br><span class="line">        &lt;a-layout-sider&gt;&lt;/a-layout-sider&gt;</span><br><span class="line">        &lt;a-layout-content&gt;</span><br><span class="line">          &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">        &lt;/a-layout-content&gt;</span><br><span class="line">      &lt;/a-layout&gt;</span><br><span class="line">    &lt;/a-layout&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.a53 &#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  background-color: rgb(220, 225, 255);</span><br><span class="line">  background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%3E%3Ctext x=&#x27;35&#x27; y=&#x27;10&#x27; font-size=&#x27;14&#x27; font-family=&#x27;system-ui, sans-serif&#x27; text-anchor=&#x27;middle&#x27; dominant-baseline=&#x27;middle&#x27;%3EA53(主页)%3C/text%3E%3C/svg%3E&quot;);</span><br><span class="line">  padding: 20px;</span><br><span class="line">  box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line">.ant-layout-header &#123;</span><br><span class="line">  height: 50px;</span><br><span class="line">  background-color:darkseagreen;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.ant-layout-sider &#123;</span><br><span class="line">  background-color:lightsalmon;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.ant-layout-content &#123;</span><br><span class="line">  background-color: aliceblue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.ant-layout-footer &#123;</span><br><span class="line">  background-color:darkslateblue;</span><br><span class="line">  height: 30px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.ant-layout &#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.ant-layout-has-sider &#123;</span><br><span class="line">  height: calc(100% - 50px);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<h2 id="侧边栏菜单"><a href="#侧边栏菜单" class="headerlink" title="侧边栏菜单"></a>侧边栏菜单</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;a53&quot;&gt;</span><br><span class="line">    &lt;a-layout&gt;</span><br><span class="line">      &lt;a-layout-header&gt;&lt;/a-layout-header&gt;</span><br><span class="line">      &lt;a-layout&gt;</span><br><span class="line">        &lt;a-layout-sider&gt;</span><br><span class="line">          &lt;a-menu theme=&quot;dark&quot; mode=&quot;inline&quot;&gt;</span><br><span class="line">            &lt;a-menu-item :key=&quot;1&quot;&gt;</span><br><span class="line">              &lt;router-link to=&quot;/a3/student&quot;&gt;菜单1&lt;/router-link&gt;</span><br><span class="line">            &lt;/a-menu-item&gt;</span><br><span class="line">            &lt;a-menu-item :key=&quot;2&quot;&gt;</span><br><span class="line">              &lt;router-link to=&quot;/a3/teacher&quot;&gt;菜单2&lt;/router-link&gt;</span><br><span class="line">            &lt;/a-menu-item&gt;</span><br><span class="line">            &lt;a-menu-item :key=&quot;3&quot;&gt;菜单3&lt;/a-menu-item&gt;</span><br><span class="line">            &lt;a-sub-menu :key=&quot;4&quot; title=&quot;菜单4&quot;&gt;</span><br><span class="line">              &lt;a-menu-item :key=&quot;41&quot;&gt;菜单41&lt;/a-menu-item&gt;</span><br><span class="line">              &lt;a-menu-item :key=&quot;42&quot;&gt;菜单42&lt;/a-menu-item&gt;</span><br><span class="line">            &lt;/a-sub-menu&gt;</span><br><span class="line">          &lt;/a-menu&gt;</span><br><span class="line">        &lt;/a-layout-sider&gt;</span><br><span class="line">        &lt;a-layout-content&gt;</span><br><span class="line">          &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">        &lt;/a-layout-content&gt;</span><br><span class="line">      &lt;/a-layout&gt;</span><br><span class="line">    &lt;/a-layout&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>a-menu-item 与 a-sub-menu 都必须为 key 属性唯一赋值，否则会产生混乱</li>
<li>router-link 标签用来切换路由，to 是目标路由的路径</li>
<li>theme 属性定义菜单的主题（默认亮色主题，dark 为暗色主题）</li>
<li>mode 属性定义子菜单的展示模式（默认弹出，inline 显示在下方）</li>
</ul>
<h2 id="菜单图标"><a href="#菜单图标" class="headerlink" title="菜单图标"></a>菜单图标</h2><p>安装图标依赖</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @ant-design/icons-vue</span><br></pre></td></tr></table></figure>
<p>菜单中使用图标</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;a53&quot;&gt;</span><br><span class="line">    &lt;a-layout&gt;</span><br><span class="line">      &lt;a-layout-header&gt;&lt;/a-layout-header&gt;</span><br><span class="line">      &lt;a-layout&gt;</span><br><span class="line">        &lt;a-layout-sider&gt;</span><br><span class="line">          &lt;a-menu theme=&quot;dark&quot; mode=&quot;inline&quot;&gt;</span><br><span class="line">            &lt;a-menu-item :key=&quot;1&quot;&gt;</span><br><span class="line">              &lt;template #icon&gt;</span><br><span class="line">                &lt;highlight-outlined /&gt;</span><br><span class="line">              &lt;/template&gt;</span><br><span class="line">              &lt;router-link to=&quot;/a3/student&quot;&gt;菜单1&lt;/router-link&gt;</span><br><span class="line">            &lt;/a-menu-item&gt;</span><br><span class="line">            &lt;a-menu-item :key=&quot;2&quot;&gt;</span><br><span class="line">              &lt;template #icon&gt;</span><br><span class="line">                &lt;align-center-outlined /&gt;</span><br><span class="line">              &lt;/template&gt;</span><br><span class="line">              &lt;router-link to=&quot;/a3/teacher&quot;&gt;菜单2&lt;/router-link&gt;</span><br><span class="line">            &lt;/a-menu-item&gt;</span><br><span class="line">            &lt;a-menu-item :key=&quot;3&quot;&gt;</span><br><span class="line">              &lt;template #icon&gt;</span><br><span class="line">                &lt;strikethrough-outlined /&gt;</span><br><span class="line">              &lt;/template&gt;</span><br><span class="line">              菜单3&lt;/a-menu-item&gt;</span><br><span class="line">            &lt;a-sub-menu :key=&quot;4&quot; title=&quot;菜单4&quot;&gt;</span><br><span class="line">              &lt;template #icon&gt;</span><br><span class="line">                &lt;sort-descending-outlined /&gt;</span><br><span class="line">              &lt;/template&gt;</span><br><span class="line">              &lt;a-menu-item :key=&quot;41&quot;&gt;菜单41&lt;/a-menu-item&gt;</span><br><span class="line">              &lt;a-menu-item :key=&quot;42&quot;&gt;菜单42&lt;/a-menu-item&gt;</span><br><span class="line">            &lt;/a-sub-menu&gt;</span><br><span class="line">          &lt;/a-menu&gt;</span><br><span class="line">        &lt;/a-layout-sider&gt;</span><br><span class="line">        &lt;a-layout-content&gt;</span><br><span class="line">          &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">        &lt;/a-layout-content&gt;</span><br><span class="line">      &lt;/a-layout&gt;</span><br><span class="line">    &lt;/a-layout&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123;HighlightOutlined, AlignCenterOutlined, StrikethroughOutlined, SortDescendingOutlined&#125; from &#x27;@ant-design/icons-vue&#x27;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>图标组件没有全局绑定，需要 import 之后才能使用</li>
<li>用 <code>&lt;template #icon&gt;&lt;/template&gt;</code> 插槽，才能确定图标展示的位置（菜单文字之前）</li>
</ul>
<p><br></p>
<h2 id="二次封装图标组件"><a href="#二次封装图标组件" class="headerlink" title="二次封装图标组件"></a>二次封装图标组件</h2><p>最终希望用统一的图标组件去使用图标，图标名只是作为一个属性值传递进去，例如：</p>
<p>使用者</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;a-icon icon=&quot;highlight-outlined&quot;&gt;&lt;/a-icon&gt;</span><br><span class="line">  &lt;a-icon icon=&quot;align-center-outlined&quot;&gt;&lt;/a-icon&gt;</span><br><span class="line">  &lt;a-icon icon=&quot;strikethrough-outlined&quot;&gt;&lt;/a-icon&gt;</span><br><span class="line">  &lt;a-icon icon=&quot;sort-descending-outlined&quot;&gt;&lt;/a-icon&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import AIcon from &#x27;../components/AIcon1.vue&#x27;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p><strong>方法1，使用 vue 组件</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">import &#123;HighlightOutlined, AlignCenterOutlined, StrikethroughOutlined, SortDescendingOutlined&#125; from &#x27;@ant-design/icons-vue&#x27;</span><br><span class="line">const props = defineProps&lt;&#123;icon:string&#125;&gt;()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;highlight-outlined v-if=&quot;icon===&#x27;highlight-outlined&#x27;&quot;&gt;&lt;/highlight-outlined&gt;</span><br><span class="line">  &lt;align-center-outlined v-else-if=&quot;icon===&#x27;align-center-outlined&#x27;&quot;&gt;&lt;/align-center-outlined&gt;</span><br><span class="line">  &lt;strikethrough-outlined v-else-if=&quot;icon===&#x27;strikethrough-outlined&#x27;&quot;&gt;&lt;/strikethrough-outlined&gt;</span><br><span class="line">  &lt;sort-descending-outlined v-else-if=&quot;icon===&#x27;sort-descending-outlined&#x27;&quot;&gt;&lt;/sort-descending-outlined&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>缺点：实现太笨</li>
</ul>
<p><br></p>
<p><strong>方法2，使用函数式组件</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; h &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> <span class="title class_">Icons</span> <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons-vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Module</span> &#123;</span><br><span class="line">  [<span class="attr">p</span>:<span class="built_in">string</span>]: <span class="built_in">any</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 参数1: 组件属性</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">AIcon</span> = (<span class="params">props:&#123;icon:<span class="built_in">string</span>&#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// console.log(props.icon)</span></span><br><span class="line">  <span class="comment">// console.log(Icons)</span></span><br><span class="line">  <span class="comment">// 参数1: 组件对象</span></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">im</span>: <span class="title class_">Module</span> = <span class="title class_">Icons</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">h</span>(im[<span class="title function_">toCamelCase</span>(props.<span class="property">icon</span>)])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">AIcon</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 将-分隔的单词转换为大驼峰命名的单词</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">toCamelCase</span>(<span class="params">str: <span class="built_in">string</span></span>) &#123; <span class="comment">// highlight-outlined</span></span><br><span class="line">  <span class="keyword">return</span> str.<span class="title function_">split</span>(<span class="string">&#x27;-&#x27;</span>) <span class="comment">// [&#x27;highlight&#x27;, &#x27;outlined&#x27;]</span></span><br><span class="line">    .<span class="title function_">map</span>(<span class="function">(<span class="params">e</span>)=&gt;</span> e.<span class="title function_">charAt</span>(<span class="number">0</span>).<span class="title function_">toUpperCase</span>() + e.<span class="title function_">slice</span>(<span class="number">1</span>) ) <span class="comment">// [&#x27;Highlight&#x27;, &#x27;Outlined&#x27;]</span></span><br><span class="line">    .<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Icons 的结构如下</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">  HighlightOutlined: HighlightOutlined组件对象,</span></span><br><span class="line"><span class="comment">  MonitorOutlined: MonitorOutlined组件对象,</span></span><br><span class="line"><span class="comment">  ...</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<ul>
<li>需要动态生成标签的时候，可以考虑使用函数式组件</li>
</ul>
<p><br></p>
<p><strong>方法3，使用 jsx 组件</strong></p>
<p>首先，安装  </p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @vitejs/plugin-vue-jsx -D</span><br></pre></td></tr></table></figure>
<p>配置 vite.config.ts</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> vueJsx <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue-jsx&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// https://vitejs.dev/config/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="title function_">vue</span>(), <span class="title function_">vueJsx</span>()]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>编写一个 Hi.tsx 组件</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">props</span>: &#123;</span><br><span class="line">    <span class="attr">msg</span>: <span class="title class_">String</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params">props: &#123; msg: <span class="built_in">string</span> &#125;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h5</span>&gt;</span>&#123;props.msg&#125;<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后被其它组件使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import Hi from &#x27;../components/Hi&#x27;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;Hi msg=&quot;Hello,World&quot;&gt;&lt;/Hi&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<p>用 jsx 实现图标组件</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> <span class="title class_">Icons</span> <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons-vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Module</span> &#123;</span><br><span class="line">  [<span class="attr">p</span>:<span class="built_in">string</span>]: <span class="built_in">any</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">toCamelCase</span>(<span class="params">str: <span class="built_in">string</span></span>) &#123; <span class="comment">// highlight-outlined</span></span><br><span class="line">  <span class="keyword">return</span> str</span><br><span class="line">    .<span class="title function_">split</span>(<span class="string">&quot;-&quot;</span>) <span class="comment">// [&#x27;highlight&#x27;, &#x27;outlined&#x27;]</span></span><br><span class="line">    .<span class="title function_">map</span>(<span class="function">(<span class="params">e</span>) =&gt;</span> e.<span class="title function_">charAt</span>(<span class="number">0</span>).<span class="title function_">toUpperCase</span>() + e.<span class="title function_">slice</span>(<span class="number">1</span>)) <span class="comment">// [&#x27;Highlight&#x27;, &#x27;Outlined&#x27;]</span></span><br><span class="line">    .<span class="title function_">join</span>(<span class="string">&quot;&quot;</span>); <span class="comment">// HighlightOutlined</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">props</span>: &#123;</span><br><span class="line">    <span class="attr">icon</span>: <span class="title class_">String</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params">props: &#123;icon: <span class="built_in">string</span>&#125;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">im</span>: <span class="title class_">Module</span> = <span class="title class_">Icons</span></span><br><span class="line">    <span class="keyword">const</span> tag = im[<span class="title function_">toCamelCase</span>(props.<span class="property">icon</span>)] <span class="comment">// 图标组件</span></span><br><span class="line">    <span class="comment">// HighlightOutlined</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function">()=&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">tag</span>&gt;</span><span class="tag">&lt;/<span class="name">tag</span>&gt;</span></span> <span class="comment">// 返回组件标签</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="动态路由与菜单"><a href="#动态路由与菜单" class="headerlink" title="动态路由与菜单"></a>动态路由与菜单</h2><p><strong>路由文件</strong></p>
<p>a6router.js</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHashHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useStorage &#125; <span class="keyword">from</span> <span class="string">&#x27;@vueuse/core&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Route</span>, <span class="title class_">Menu</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../model/Model8080&#x27;</span></span><br><span class="line"><span class="keyword">const</span> clientRoutes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;login&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;../views/A6Login.vue&#x27;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/404&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;404&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;../views/A6NotFound.vue&#x27;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;main&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;../views/A6Main.vue&#x27;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/:pathMatcher(.*)*&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;remaining&#x27;</span>,</span><br><span class="line">    <span class="attr">redirect</span>: <span class="string">&#x27;/404&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHashHistory</span>(),</span><br><span class="line">  <span class="attr">routes</span>: clientRoutes</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> serverMenus = useStorage&lt;<span class="title class_">Menu</span>[]&gt;(<span class="string">&#x27;serverMenus&#x27;</span>, [])</span><br><span class="line"><span class="keyword">const</span> serverRoutes = useStorage&lt;<span class="title class_">Route</span>[]&gt;(<span class="string">&#x27;serverRoutes&#x27;</span>, [])</span><br><span class="line"><span class="title function_">addServerRoutes</span>(serverRoutes.<span class="property">value</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">addServerRoutes</span>(<span class="params">routeList: Route[]</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> r <span class="keyword">of</span> routeList) &#123;</span><br><span class="line">    <span class="keyword">if</span> (r.<span class="property">parentName</span>) &#123;</span><br><span class="line">      router.<span class="title function_">addRoute</span>(r.<span class="property">parentName</span>, &#123;</span><br><span class="line">        <span class="attr">path</span>: r.<span class="property">path</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(r.<span class="property">component</span>),</span><br><span class="line">        <span class="attr">name</span>: r.<span class="property">name</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  serverRoutes.<span class="property">value</span> = routeList</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">resetRoutes</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> r <span class="keyword">of</span> clientRoutes) &#123;</span><br><span class="line">    router.<span class="title function_">addRoute</span>(r)</span><br><span class="line">  &#125;</span><br><span class="line">  serverRoutes.<span class="property">value</span> = <span class="literal">null</span></span><br><span class="line">  serverMenus.<span class="property">value</span> = <span class="literal">null</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure>
<p>本文件重要的函数及变量</p>
<ul>
<li>addServerRoutes 函数向路由表中添加由服务器提供的路由，路由分成两部分<ul>
<li>clientRoutes 这是客户端固定的路由</li>
<li>serverRoutes 这是服务器变化的路由，存储于 localStorage</li>
</ul>
</li>
<li>resetRoutes 函数用来将路由重置为 clientRoutes <ul>
<li>vue-router@4 中的 addRoute 方法会【覆盖】同名路由，这是这种实现的关键</li>
<li>因此，服务器返回的路由最好是 main 的子路由，这样重置时就会比较简单，用之前的 main 一覆盖就完事了</li>
</ul>
</li>
<li>serverMenus 变量记录服务器变化的菜单，存储于 localStorage</li>
</ul>
<p><br></p>
<p><strong>登录组件</strong></p>
<p>动态路由应当在登录时生成，A6Login.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;login&quot;&gt;</span><br><span class="line">    &lt;a-form :label-col=&quot;&#123; span: 6 &#125;&quot; autocomplete=&quot;off&quot;&gt;</span><br><span class="line">      &lt;a-form-item label=&quot;用户名&quot; v-bind=&quot;validateInfos.username&quot;&gt;</span><br><span class="line">        &lt;a-input v-model:value=&quot;dto.username&quot; /&gt;</span><br><span class="line">      &lt;/a-form-item&gt;</span><br><span class="line">      &lt;a-form-item label=&quot;密码&quot; v-bind=&quot;validateInfos.password&quot;&gt;</span><br><span class="line">        &lt;a-input-password v-model:value=&quot;dto.password&quot; /&gt;</span><br><span class="line">      &lt;/a-form-item&gt;</span><br><span class="line">      &lt;a-form-item :wrapper-col=&quot;&#123; offset: 6, span: 16 &#125;&quot;&gt;</span><br><span class="line">        &lt;a-button type=&quot;primary&quot; @click=&quot;onClick&quot;&gt;Submit&lt;/a-button&gt;</span><br><span class="line">      &lt;/a-form-item&gt;      </span><br><span class="line">    &lt;/a-form&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref, onMounted &#125; from &#x27;vue&#x27;</span><br><span class="line">import &#123; Form &#125; from &#x27;ant-design-vue&#x27;</span><br><span class="line">import &#123; useRouter &#125; from &#x27;vue-router&#x27;</span><br><span class="line">import axios from &#x27;../api/request&#x27;</span><br><span class="line">import &#123; useRequest &#125; from &#x27;vue-request&#x27;</span><br><span class="line">import &#123; AxiosRespToken, LoginDto, AxiosRespMenuAndRoute &#125; from &#x27;../model/Model8080&#x27;</span><br><span class="line">import &#123; resetRoutes, addServerRoutes, serverMenus &#125; from &#x27;../router/a6router&#x27;</span><br><span class="line">const dto = ref(&#123;username:&#x27;&#x27;, password:&#x27;&#x27;&#125;)</span><br><span class="line">const rules = ref(&#123;</span><br><span class="line">  username: [</span><br><span class="line">    &#123;required: true, message:&#x27;用户名必填&#x27;&#125;</span><br><span class="line">  ],</span><br><span class="line">  password:[</span><br><span class="line">    &#123;required: true, message:&#x27;密码必填&#x27;&#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line">const &#123; validateInfos, validate &#125; = Form.useForm(dto, rules)</span><br><span class="line">const router = useRouter()</span><br><span class="line">const &#123; runAsync:login &#125; = useRequest&lt;AxiosRespToken, LoginDto[]&gt;((dto)=&gt; axios.post(&#x27;/api/loginJwt&#x27;, dto), &#123;manual:true&#125;)</span><br><span class="line">const &#123; runAsync:menu &#125; = useRequest&lt;AxiosRespMenuAndRoute, string[]&gt;((username)=&gt; axios.get(`/api/menu/$&#123;username&#125;`), &#123;manual:true&#125;)</span><br><span class="line">async function onClick() &#123;</span><br><span class="line">  try &#123;</span><br><span class="line">    await validate()</span><br><span class="line">    const loginResp = await login(dto.value</span><br><span class="line">    if(loginResp.data.code === 200) &#123; // 登录成功</span><br><span class="line">      const token = loginResp.data.data.token</span><br><span class="line">      const menuResp = await menu(dto.value.username)</span><br><span class="line">      const routeList = menuResp.data.data.routeList</span><br><span class="line">      addServerRoutes(routeList)</span><br><span class="line">      serverMenus.value = menuResp.data.data.menuTree</span><br><span class="line">      router.push(&#x27;/&#x27;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125; catch (e) &#123;</span><br><span class="line">    console.error(e)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">onMounted(()=&gt;&#123;</span><br><span class="line">  resetRoutes()</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.login&#123;</span><br><span class="line">  margin: 200px auto;</span><br><span class="line">  width: 25%;</span><br><span class="line">  padding: 20px;</span><br><span class="line">  height: 180px;</span><br><span class="line">  background-color: antiquewhite;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>登录成功后去请求 <code>/api/menu/&#123;username&#125;</code>  获取该用户的菜单和路由</li>
<li>router.push 方法用来以编程方式跳转至主页路由</li>
</ul>
<p><br></p>
<p><strong>主页组件</strong></p>
<p>A6Main.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;a6main&quot;&gt;</span><br><span class="line">    &lt;a-layout&gt;</span><br><span class="line">      &lt;a-layout-header&gt;</span><br><span class="line">      &lt;/a-layout-header&gt;</span><br><span class="line">      &lt;a-layout&gt;</span><br><span class="line">        &lt;a-layout-sider&gt;</span><br><span class="line">          &lt;a-menu mode=&quot;inline&quot; theme=&quot;dark&quot;&gt;</span><br><span class="line">            &lt;template v-for=&quot;m1 of serverMenus&quot;&gt;</span><br><span class="line">              &lt;a-sub-menu v-if=&quot;m1.children&quot; :key=&quot;m1.id&quot; :title=&quot;m1.title&quot;&gt;</span><br><span class="line">                &lt;template #icon&gt;&lt;a-icon :icon=&quot;m1.icon&quot;&gt;&lt;/a-icon&gt;&lt;/template&gt;</span><br><span class="line">                &lt;a-menu-item v-for=&quot;m2 of m1.children&quot; :key=&quot;m2.id&quot;&gt;</span><br><span class="line">                  &lt;template #icon&gt;&lt;a-icon :icon=&quot;m2.icon&quot;&gt;&lt;/a-icon&gt;&lt;/template&gt;</span><br><span class="line">                  &lt;router-link v-if=&quot;m2.routePath&quot; :to=&quot;m2.routePath&quot;&gt;&#123;&#123;m2.title&#125;&#125;&lt;/router-link&gt;</span><br><span class="line">                  &lt;span v-else&gt;&#123;&#123;m2.title&#125;&#125;&lt;/span&gt;</span><br><span class="line">                &lt;/a-menu-item&gt;</span><br><span class="line">              &lt;/a-sub-menu&gt;</span><br><span class="line">              &lt;a-menu-item v-else :key=&quot;m1.id&quot;&gt;</span><br><span class="line">                &lt;template #icon&gt;&lt;a-icon :icon=&quot;m1.icon&quot;&gt;&lt;/a-icon&gt;&lt;/template&gt;</span><br><span class="line">                &lt;router-link v-if=&quot;m1.routePath&quot; :to=&quot;m1.routePath&quot;&gt;&#123;&#123;m1.title&#125;&#125;&lt;/router-link&gt;</span><br><span class="line">                &lt;span v-else&gt;&#123;&#123;m1.title&#125;&#125;&lt;/span&gt;</span><br><span class="line">              &lt;/a-menu-item&gt;</span><br><span class="line">            &lt;/template&gt;            </span><br><span class="line">          &lt;/a-menu&gt;</span><br><span class="line">        &lt;/a-layout-sider&gt;</span><br><span class="line">        &lt;a-layout-content&gt;</span><br><span class="line">          &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">        &lt;/a-layout-content&gt;</span><br><span class="line">      &lt;/a-layout&gt;</span><br><span class="line">    &lt;/a-layout&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import AIcon from &#x27;../components/AIcon3&#x27; // jsx icon 组件</span><br><span class="line">import &#123; serverMenus &#125; from &#x27;../router/a6router&#x27;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.a6main &#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  background-color: rgb(220, 225, 255);</span><br><span class="line">  box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line">.ant-layout-header &#123;</span><br><span class="line">  height: 50px;</span><br><span class="line">  background-color:darkseagreen;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.ant-layout-sider &#123;</span><br><span class="line">  background-color:lightsalmon;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.ant-layout-content &#123;</span><br><span class="line">  background-color: aliceblue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.ant-layout-footer &#123;</span><br><span class="line">  background-color:darkslateblue;</span><br><span class="line">  height: 30px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.ant-layout &#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.ant-layout-has-sider &#123;</span><br><span class="line">  height: calc(100% - 50px);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="token-使用"><a href="#token-使用" class="headerlink" title="token 使用"></a>token 使用</h2><ol>
<li>获取用户信息，例如服务器端可以把用户名、该用户的路由、菜单信息都统一从 token 返回</li>
<li>前端路由跳转依据，例如跳转前检查 token，如果不存在，表示未登录，就避免跳转至某些路由</li>
<li>后端 api 访问依据，例如每次发请求携带 token，后端需要身份校验的 api 需要用到</li>
</ol>
<p><br></p>
<h1 id="pinia"><a href="#pinia" class="headerlink" title="pinia"></a>pinia</h1><p>需求：在组件 p1 里更新了数据，主页组件也同步更新显示</p>
<ul>
<li>storage 虽然可以实现多个组件的数据共享，但是需要【主动访问】才能获取更新后的数据</li>
<li>本例中由于没有涉及主页组件的 mounted 操作，因此并不会【主动】获取 storage 的数据 </li>
</ul>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install pinia</span><br></pre></td></tr></table></figure>
<p>在 main.ts 中引入</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="title function_">createApp</span>(<span class="variable constant_">A6</span>).<span class="title function_">use</span>(antdv).<span class="title function_">use</span>(router).<span class="title function_">use</span>(<span class="title function_">createPinia</span>()).<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="定义Store"><a href="#定义Store" class="headerlink" title="定义Store"></a>定义Store</h2><p>再新建 store 目录来管理共享数据，下面是 /src/store/UserInfo.ts</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;../api/request&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&quot;pinia&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">UserInfoDto</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../model/Model8080&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useUserInfo = <span class="title function_">defineStore</span>(<span class="string">&#x27;userInfo&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">username</span>: <span class="string">&#x27;&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;&#x27;</span>, <span class="attr">sex</span>: <span class="string">&#x27;&#x27;</span> &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">get</span>(<span class="params">username: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> resp = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">`/api/info/<span class="subst">$&#123;username&#125;</span>`</span>)</span><br><span class="line">      <span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="variable language_">this</span>, resp.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">update</span>(<span class="params">dto: UserInfoDto</span>) &#123;</span><br><span class="line">      <span class="keyword">await</span> axios.<span class="title function_">post</span>(<span class="string">&#x27;/api/info&#x27;</span>, dto)</span><br><span class="line">      <span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="variable language_">this</span>, dto)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>定义了 useUserInfo 函数，用来获取共享数据，它可能用于多个组件</p>
<ul>
<li>命名习惯上，函数变量以 use 打头</li>
</ul>
</li>
<li><p>state 定义数据格式</p>
</li>
<li><p>actions 定义操作数据的方法</p>
<ul>
<li><p>get 方法用来获取用户信息</p>
</li>
<li><p>update 方法用来修改用户信息</p>
</li>
</ul>
</li>
</ul>
<ul>
<li>由于 useRequest 必须放在 setup 函数内，这里简化起见，直接使用了 axios</li>
</ul>
<p>获取用户信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;a6main&quot;&gt;</span><br><span class="line">    &lt;a-layout&gt;</span><br><span class="line">      &lt;a-layout-header&gt;</span><br><span class="line">        &lt;span&gt;&#123;&#123;serverUsername&#125;&#125; 【&#123;&#123;userInfo.name&#125;&#125; - &#123;&#123;userInfo.sex&#125;&#125;】&lt;/span&gt;</span><br><span class="line">      &lt;/a-layout-header&gt;</span><br><span class="line">      &lt;a-layout&gt;</span><br><span class="line">        &lt;!-- ... --&gt;</span><br><span class="line">      &lt;/a-layout&gt;</span><br><span class="line">    &lt;/a-layout&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; onMounted &#125; from &#x27;vue&#x27;;</span><br><span class="line">import AIcon from &#x27;../components/AIcon3&#x27; // jsx icon 组件</span><br><span class="line">import &#123; serverMenus, serverUsername &#125; from &#x27;../router/a6router&#x27;</span><br><span class="line">import &#123; useUserInfo &#125; from &#x27;../store/UserInfo&#x27;</span><br><span class="line">const userInfo = useUserInfo()</span><br><span class="line"></span><br><span class="line">onMounted(()=&gt;&#123;</span><br><span class="line">  userInfo.get(serverUsername.value)</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>修改用户信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;a6p1&quot;&gt;</span><br><span class="line">    &lt;h3&gt;修改用户信息&lt;/h3&gt;</span><br><span class="line">    &lt;hr&gt;</span><br><span class="line">    &lt;a-form&gt;</span><br><span class="line">      &lt;a-form-item label=&quot;用户名&quot;&gt;</span><br><span class="line">        &lt;a-input readonly v-model:value=&quot;dto.username&quot;&gt;&lt;/a-input&gt;</span><br><span class="line">      &lt;/a-form-item&gt;</span><br><span class="line">      &lt;a-form-item label=&quot;姓名&quot; v-bind=&quot;validateInfos.name&quot;&gt;</span><br><span class="line">        &lt;a-input v-model:value=&quot;dto.name&quot;&gt;&lt;/a-input&gt;</span><br><span class="line">      &lt;/a-form-item&gt;</span><br><span class="line">      &lt;a-form-item label=&quot;性别&quot;&gt;</span><br><span class="line">        &lt;a-radio-group v-model:value=&quot;dto.sex&quot;&gt;</span><br><span class="line">          &lt;a-radio-button value=&quot;男&quot;&gt;男&lt;/a-radio-button&gt;</span><br><span class="line">          &lt;a-radio-button value=&quot;女&quot;&gt;女&lt;/a-radio-button&gt;</span><br><span class="line">        &lt;/a-radio-group&gt;</span><br><span class="line">      &lt;/a-form-item&gt;</span><br><span class="line">    &lt;/a-form&gt;</span><br><span class="line">    &lt;a-button type=&quot;primary&quot; @click=&quot;onClick&quot;&gt;确定&lt;/a-button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; Form &#125; from &#x27;ant-design-vue&#x27;</span><br><span class="line">import &#123; onMounted, ref &#125; from &#x27;vue&#x27;</span><br><span class="line">import &#123; UserInfoDto &#125; from &#x27;../model/Model8080&#x27;</span><br><span class="line">import &#123; useUserInfo &#125; from &#x27;../store/UserInfo&#x27;;</span><br><span class="line">const dto = ref&lt;UserInfoDto&gt;(&#123; username: &#x27;&#x27;, name: &#x27;&#x27;, sex: &#x27;&#x27; &#125;)</span><br><span class="line">const userInfo = useUserInfo()</span><br><span class="line">onMounted(()=&gt;&#123;</span><br><span class="line">  Object.assign(dto.value, userInfo)</span><br><span class="line">&#125;)</span><br><span class="line">const rules = ref(&#123;</span><br><span class="line">  name: [</span><br><span class="line">    &#123;required: true, message:&#x27;姓名必填&#x27;&#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line">const &#123; validateInfos, validate &#125; = Form.useForm(dto, rules)</span><br><span class="line">async function onClick() &#123;</span><br><span class="line">  try &#123;</span><br><span class="line">    await validate()</span><br><span class="line">    await userInfo.update(dto.value)</span><br><span class="line">  &#125; catch (e) &#123;</span><br><span class="line">    console.error(e)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>不能直接把 userInfo 绑定到表单，需要 dto 中转一下</li>
<li>userInfo.update 和 useInfo.get 返回的都是 Promise 对象，可以配合 await 一起用</li>
</ul>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%89%8D%E7%AB%AF/">前端</a><a class="post-meta__tags" href="/tags/Vue/">Vue</a></div><div class="post_share"><div class="social-share" data-image="https://lmh-hexo-blog-img.oss-cn-hangzhou.aliyuncs.com/img/202307101631203.png" data-sites="wechat,weibo,qq,facebook,twitter"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/Linux01/" title="Linux学习01"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://lmh-hexo-blog-img.oss-cn-hangzhou.aliyuncs.com/img/202307121825431.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Linux学习01</div></div></a></div><div class="next-post pull-right"><a href="/post/TypeScript/" title="TypeScript基础"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://lmh-hexo-blog-img.oss-cn-hangzhou.aliyuncs.com/img/202307101641411.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">TypeScript基础</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/post/Java%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/" title="Java前端技术基础"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://lmh-hexo-blog-img.oss-cn-hangzhou.aliyuncs.com/img/202307051011959.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-05</div><div class="title">Java前端技术基础</div></div></a></div><div><a href="/post/TypeScript/" title="TypeScript基础"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://lmh-hexo-blog-img.oss-cn-hangzhou.aliyuncs.com/img/202307101641411.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-09</div><div class="title">TypeScript基础</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Livere</span><span class="switch-btn"></span><span class="second-comment">Gitalk</span></div></div><div class="comment-wrap"><div><div id="lv-container" data-id="city" data-uid="MTAyMC81NjU4My8zMzA0Ng=="></div></div><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "/img/loading.gif" data-lazy-src="https://lmh-hexo-blog-img.oss-cn-hangzhou.aliyuncs.com/img/202206081622744.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">麦子落</div><div class="author-info__description">windCrain</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">37</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">28</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Wind-chasin-rain"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Wind-chasin-rain" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-number">1.</span> <span class="toc-text">环境准备</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.1.</span> <span class="toc-text">创建项目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E7%A0%81-IDE"><span class="toc-number">1.2.</span> <span class="toc-text">编码 IDE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-devtools"><span class="toc-number">1.3.</span> <span class="toc-text">安装 devtools</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E7%AB%AF%E5%8F%A3"><span class="toc-number">1.4.</span> <span class="toc-text">修改端口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%90%86"><span class="toc-number">1.5.</span> <span class="toc-text">配置代理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84"><span class="toc-number">1.6.</span> <span class="toc-text">项目结构</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Vue-%E7%BB%84%E4%BB%B6"><span class="toc-number">2.</span> <span class="toc-text">Vue 组件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#main-ts"><span class="toc-number">2.1.</span> <span class="toc-text">main.ts</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ref-%E4%B8%8E-reactive"><span class="toc-number">2.2.</span> <span class="toc-text">ref 与 reactive</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E7%BB%91%E5%AE%9A"><span class="toc-number">2.3.</span> <span class="toc-text">属性绑定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A"><span class="toc-number">2.4.</span> <span class="toc-text">事件绑定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A8%E5%8D%95%E7%BB%91%E5%AE%9A"><span class="toc-number">2.5.</span> <span class="toc-text">表单绑定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7"><span class="toc-number">2.6.</span> <span class="toc-text">计算属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xhr"><span class="toc-number">2.7.</span> <span class="toc-text">xhr</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#axios"><span class="toc-number">2.8.</span> <span class="toc-text">axios</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E4%B8%8E%E5%88%97%E8%A1%A8"><span class="toc-number">2.9.</span> <span class="toc-text">条件与列表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%91%E5%90%AC%E5%99%A8"><span class="toc-number">2.10.</span> <span class="toc-text">监听器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vueuse"><span class="toc-number">2.11.</span> <span class="toc-text">vueuse</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#useRequest"><span class="toc-number">2.12.</span> <span class="toc-text">useRequest</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#usePagination"><span class="toc-number">2.13.</span> <span class="toc-text">usePagination</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%90%E7%BB%84%E4%BB%B6"><span class="toc-number">2.14.</span> <span class="toc-text">子组件</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Antdv"><span class="toc-number">3.</span> <span class="toc-text">Antdv</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A8%E6%A0%BC"><span class="toc-number">3.1.</span> <span class="toc-text">表格</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E9%A1%B5"><span class="toc-number">3.2.</span> <span class="toc-text">分页</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%90%9C%E7%B4%A2%E3%80%81%E5%88%A0%E9%99%A4"><span class="toc-number">3.3.</span> <span class="toc-text">搜索、删除</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B0%E5%A2%9E%E3%80%81%E4%BF%AE%E6%94%B9"><span class="toc-number">3.4.</span> <span class="toc-text">新增、修改</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E6%B6%88%E6%81%AF"><span class="toc-number">3.5.</span> <span class="toc-text">全局消息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A8%E5%8D%95%E6%A0%A1%E9%AA%8C"><span class="toc-number">3.6.</span> <span class="toc-text">表单校验</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#vue-router"><span class="toc-number">4.</span> <span class="toc-text">vue-router</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA-router"><span class="toc-number">4.1.</span> <span class="toc-text">创建 router</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E5%AF%BC%E5%85%A5"><span class="toc-number">4.2.</span> <span class="toc-text">动态导入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B5%8C%E5%A5%97%E8%B7%AF%E7%94%B1"><span class="toc-number">4.3.</span> <span class="toc-text">嵌套路由</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%87%8D%E5%AE%9A%E5%90%91"><span class="toc-number">4.4.</span> <span class="toc-text">重定向</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E9%A1%B5%E5%B8%83%E5%B1%80"><span class="toc-number">4.5.</span> <span class="toc-text">主页布局</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%A7%E8%BE%B9%E6%A0%8F%E8%8F%9C%E5%8D%95"><span class="toc-number">4.6.</span> <span class="toc-text">侧边栏菜单</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8F%9C%E5%8D%95%E5%9B%BE%E6%A0%87"><span class="toc-number">4.7.</span> <span class="toc-text">菜单图标</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E6%AC%A1%E5%B0%81%E8%A3%85%E5%9B%BE%E6%A0%87%E7%BB%84%E4%BB%B6"><span class="toc-number">4.8.</span> <span class="toc-text">二次封装图标组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E4%B8%8E%E8%8F%9C%E5%8D%95"><span class="toc-number">4.9.</span> <span class="toc-text">动态路由与菜单</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#token-%E4%BD%BF%E7%94%A8"><span class="toc-number">4.10.</span> <span class="toc-text">token 使用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#pinia"><span class="toc-number">5.</span> <span class="toc-text">pinia</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">5.1.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89Store"><span class="toc-number">5.2.</span> <span class="toc-text">定义Store</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/post/%E7%94%A8Docker%E9%83%A8%E7%BD%B2GeminiPro%20Chat%E9%A1%B9%E7%9B%AE/" title="用Docker部署GeminiPro Chat项目"><img src= "/img/loading.gif" data-lazy-src="https://lmh-hexo-blog-img.oss-cn-hangzhou.aliyuncs.com/img/202312291714519.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="用Docker部署GeminiPro Chat项目"/></a><div class="content"><a class="title" href="/post/%E7%94%A8Docker%E9%83%A8%E7%BD%B2GeminiPro%20Chat%E9%A1%B9%E7%9B%AE/" title="用Docker部署GeminiPro Chat项目">用Docker部署GeminiPro Chat项目</a><time datetime="2023-12-29T09:07:55.000Z" title="发表于 2023-12-29 17:07:55">2023-12-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/Linux03/" title="Linux学习03"><img src= "/img/loading.gif" data-lazy-src="https://lmh-hexo-blog-img.oss-cn-hangzhou.aliyuncs.com/img/202307191828815.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux学习03"/></a><div class="content"><a class="title" href="/post/Linux03/" title="Linux学习03">Linux学习03</a><time datetime="2023-07-19T10:07:55.000Z" title="发表于 2023-07-19 18:07:55">2023-07-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/Linux02/" title="Linux学习02"><img src= "/img/loading.gif" data-lazy-src="https://lmh-hexo-blog-img.oss-cn-hangzhou.aliyuncs.com/img/202307161939739.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux学习02"/></a><div class="content"><a class="title" href="/post/Linux02/" title="Linux学习02">Linux学习02</a><time datetime="2023-07-16T11:37:55.000Z" title="发表于 2023-07-16 19:37:55">2023-07-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/Linux01/" title="Linux学习01"><img src= "/img/loading.gif" data-lazy-src="https://lmh-hexo-blog-img.oss-cn-hangzhou.aliyuncs.com/img/202307121825431.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux学习01"/></a><div class="content"><a class="title" href="/post/Linux01/" title="Linux学习01">Linux学习01</a><time datetime="2023-07-12T10:30:55.000Z" title="发表于 2023-07-12 18:30:55">2023-07-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/Vue3/" title="Vue3前端框架"><img src= "/img/loading.gif" data-lazy-src="https://lmh-hexo-blog-img.oss-cn-hangzhou.aliyuncs.com/img/202307101631203.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Vue3前端框架"/></a><div class="content"><a class="title" href="/post/Vue3/" title="Vue3前端框架">Vue3前端框架</a><time datetime="2023-07-10T08:31:55.000Z" title="发表于 2023-07-10 16:31:55">2023-07-10</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://lmh-hexo-blog-img.oss-cn-hangzhou.aliyuncs.com/img/202307101631203.png')"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By 麦子落</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">期待着彩虹 所以开了窗</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadLivere () {
  if (typeof LivereTower === 'object') {
    window.LivereTower.init()
  }
  else {
    (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
    })(document, 'script');
  }
}

if ('Livere' === 'Livere' || !false) {
  if (false) btf.loadComment(document.getElementById('lv-container'), loadLivere)
  else loadLivere()
}
else {
  function loadOtherComment () {
    loadLivere()
  }
}</script><script>function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: 'b465fbe0185a2888f673',
      clientSecret: '5da850f6cd3148260a788141329a0afa5ecb87be',
      repo: 'Wind-chasin-rain.github.io',
      owner: 'Wind-chasin-rain',
      admin: ['Wind-chasin-rain'],
      id: '9d2f2f631edc136200f90507a5cfdbe4',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    getCSS('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css')
    getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Livere' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><div class="aplayer no-destroy" data-id="8284543052" data-server="tencent" data-type="playlist" data-fixed="true" data-autoplay="false" data-order="random"></div><script type="text/javascript" src ="/js/mirror.js" ></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></body></html>